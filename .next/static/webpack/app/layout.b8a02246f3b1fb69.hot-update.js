"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/layout",{

/***/ "(app-pages-browser)/./src/lib/storage.ts":
/*!****************************!*\
  !*** ./src/lib/storage.ts ***!
  \****************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addListeningTime: function() { return /* binding */ addListeningTime; },\n/* harmony export */   bulkSetSurahStatus: function() { return /* binding */ bulkSetSurahStatus; },\n/* harmony export */   clearAnchorIssues: function() { return /* binding */ clearAnchorIssues; },\n/* harmony export */   deleteCustomMutashabih: function() { return /* binding */ deleteCustomMutashabih; },\n/* harmony export */   exportBackup: function() { return /* binding */ exportBackup; },\n/* harmony export */   findAnchorForRange: function() { return /* binding */ findAnchorForRange; },\n/* harmony export */   getCurrentDayInCycle: function() { return /* binding */ getCurrentDayInCycle; },\n/* harmony export */   getCustomMutashabihat: function() { return /* binding */ getCustomMutashabihat; },\n/* harmony export */   getCycleStart: function() { return /* binding */ getCycleStart; },\n/* harmony export */   getDueNodes: function() { return /* binding */ getDueNodes; },\n/* harmony export */   getErrorsByAnchor: function() { return /* binding */ getErrorsByAnchor; },\n/* harmony export */   getLearnedVersesInPart: function() { return /* binding */ getLearnedVersesInPart; },\n/* harmony export */   getListeningCompletedToday: function() { return /* binding */ getListeningCompletedToday; },\n/* harmony export */   getListeningProgress: function() { return /* binding */ getListeningProgress; },\n/* harmony export */   getListeningStats: function() { return /* binding */ getListeningStats; },\n/* harmony export */   getListeningStatsForSurah: function() { return /* binding */ getListeningStatsForSurah; },\n/* harmony export */   getMemoryNodes: function() { return /* binding */ getMemoryNodes; },\n/* harmony export */   getMindMap: function() { return /* binding */ getMindMap; },\n/* harmony export */   getMindMaps: function() { return /* binding */ getMindMaps; },\n/* harmony export */   getMutashabihatDecisions: function() { return /* binding */ getMutashabihatDecisions; },\n/* harmony export */   getPartMindMap: function() { return /* binding */ getPartMindMap; },\n/* harmony export */   getPartMindMaps: function() { return /* binding */ getPartMindMaps; },\n/* harmony export */   getReviewErrors: function() { return /* binding */ getReviewErrors; },\n/* harmony export */   getSettings: function() { return /* binding */ getSettings; },\n/* harmony export */   getSurahLearnedStatus: function() { return /* binding */ getSurahLearnedStatus; },\n/* harmony export */   getSuspendedAnchors: function() { return /* binding */ getSuspendedAnchors; },\n/* harmony export */   getTotalLearnedVerses: function() { return /* binding */ getTotalLearnedVerses; },\n/* harmony export */   importBackup: function() { return /* binding */ importBackup; },\n/* harmony export */   isSurahSkipped: function() { return /* binding */ isSurahSkipped; },\n/* harmony export */   isVerseLearned: function() { return /* binding */ isVerseLearned; },\n/* harmony export */   markListeningComplete: function() { return /* binding */ markListeningComplete; },\n/* harmony export */   postponeNode: function() { return /* binding */ postponeNode; },\n/* harmony export */   removeReviewError: function() { return /* binding */ removeReviewError; },\n/* harmony export */   resetAllMaturity: function() { return /* binding */ resetAllMaturity; },\n/* harmony export */   resetMutashabihatDecisions: function() { return /* binding */ resetMutashabihatDecisions; },\n/* harmony export */   saveCustomMutashabih: function() { return /* binding */ saveCustomMutashabih; },\n/* harmony export */   saveListeningProgress: function() { return /* binding */ saveListeningProgress; },\n/* harmony export */   saveMemoryNodes: function() { return /* binding */ saveMemoryNodes; },\n/* harmony export */   saveMindMap: function() { return /* binding */ saveMindMap; },\n/* harmony export */   savePartMindMap: function() { return /* binding */ savePartMindMap; },\n/* harmony export */   saveReviewError: function() { return /* binding */ saveReviewError; },\n/* harmony export */   saveSettings: function() { return /* binding */ saveSettings; },\n/* harmony export */   setCycleStart: function() { return /* binding */ setCycleStart; },\n/* harmony export */   setMutashabihatDecision: function() { return /* binding */ setMutashabihatDecision; },\n/* harmony export */   setSurahMaturity: function() { return /* binding */ setSurahMaturity; },\n/* harmony export */   sm2: function() { return /* binding */ sm2; },\n/* harmony export */   syncMemoryNodesWithLearned: function() { return /* binding */ syncMemoryNodesWithLearned; },\n/* harmony export */   toggleSurahLearned: function() { return /* binding */ toggleSurahLearned; },\n/* harmony export */   toggleSurahSkipped: function() { return /* binding */ toggleSurahSkipped; },\n/* harmony export */   toggleVerseLearned: function() { return /* binding */ toggleVerseLearned; },\n/* harmony export */   updateMemoryNode: function() { return /* binding */ updateMemoryNode; },\n/* harmony export */   updateSetting: function() { return /* binding */ updateSetting; }\n/* harmony export */ });\n/* harmony import */ var _quranData__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./quranData */ \"(app-pages-browser)/./src/lib/quranData.ts\");\n/* harmony import */ var idb_keyval__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! idb-keyval */ \"(app-pages-browser)/./node_modules/idb-keyval/dist/index.js\");\n// ========================================\n// Storage Service - With Part Mindmaps & Review Errors\n// ========================================\n\n\n// ========================================\n// Storage Engine Migration & Helpers\n// ========================================\nconst customStore =  true ? (0,idb_keyval__WEBPACK_IMPORTED_MODULE_1__.createStore)(\"quran-app-db\", \"quran-app-store\") : 0;\n/**\n * Migration helper to move data from localStorage to IndexedDB once.\n */ async function migrateFromLocalStorage() {\n    if ( false || !customStore) return;\n    const migrationFlag = \"quran-app-migrated-to-idb\";\n    if (localStorage.getItem(migrationFlag)) return;\n    for (const key of Object.values(STORAGE_KEYS)){\n        const value = localStorage.getItem(key);\n        if (value) {\n            try {\n                await (0,idb_keyval__WEBPACK_IMPORTED_MODULE_1__.set)(key, JSON.parse(value), customStore);\n            } catch (e) {\n                console.error(\"Migration failed for key \".concat(key, \":\"), e);\n            }\n        }\n    }\n    localStorage.setItem(migrationFlag, \"true\");\n    console.log(\"Successfully migrated data from localStorage to IndexedDB\");\n}\n// Initial migration trigger\nif (true) {\n    migrateFromLocalStorage();\n}\n/**\n * Global cache to keep synchronous access for existing UI while persisting asynchronously.\n * This ensures the UI remains snappy while data is safely stored in IndexedDB.\n */ const storageCache = {};\nasync function loadIntoCache() {\n    if ( false || !customStore) return;\n    for (const key of Object.values(STORAGE_KEYS)){\n        storageCache[key] = await (0,idb_keyval__WEBPACK_IMPORTED_MODULE_1__.get)(key, customStore);\n    }\n}\n// Start loading cache\nif (true) {\n    loadIntoCache();\n}\nfunction getFromCache(key, defaultValue) {\n    if (false) {}\n    const cached = storageCache[key];\n    return cached !== undefined ? cached : defaultValue;\n}\nfunction saveToCacheAndStore(key, value) {\n    storageCache[key] = value;\n    if ( true && customStore) {\n        (0,idb_keyval__WEBPACK_IMPORTED_MODULE_1__.set)(key, value, customStore).catch((err)=>console.error(\"Failed to persist \".concat(key, \":\"), err));\n    }\n}\nconst STORAGE_KEYS = {\n    SETTINGS: \"quran-app-settings\",\n    MEMORY_NODES: \"quran-app-memory-nodes\",\n    MINDMAPS: \"quran-app-mindmaps\",\n    PART_MINDMAPS: \"quran-app-part-mindmaps\",\n    LISTENING_PROGRESS: \"quran-app-listening-progress\",\n    LISTENING_STATS: \"quran-app-listening-stats\",\n    CYCLE_START: \"quran-app-cycle-start\",\n    LISTENING_COMPLETE: \"quran-app-listening-complete\",\n    REVIEW_ERRORS: \"quran-app-review-errors\",\n    MUTASHABIHAT_DECISIONS: \"quran-app-mutashabihat-decisions\",\n    CUSTOM_MUTASHABIHAT: \"quran-app-custom-mutashabihat\"\n};\nconst DEFAULT_SETTINGS = {\n    completionDays: 30,\n    activePart: 4,\n    learnedVerses: {},\n    skippedSurahs: []\n};\nfunction getSettings() {\n    return getFromCache(STORAGE_KEYS.SETTINGS, DEFAULT_SETTINGS);\n}\nfunction saveSettings(settings) {\n    saveToCacheAndStore(STORAGE_KEYS.SETTINGS, settings);\n}\nfunction updateSetting(key, value) {\n    const settings = getSettings();\n    settings[key] = value;\n    saveSettings(settings);\n}\nfunction isSurahSkipped(surahId) {\n    var _settings_skippedSurahs;\n    const settings = getSettings();\n    return ((_settings_skippedSurahs = settings.skippedSurahs) === null || _settings_skippedSurahs === void 0 ? void 0 : _settings_skippedSurahs.includes(surahId)) || false;\n}\nfunction toggleSurahSkipped(surahId) {\n    const settings = getSettings();\n    const current = new Set(settings.skippedSurahs || []);\n    if (current.has(surahId)) {\n        current.delete(surahId);\n    } else {\n        current.add(surahId);\n        // Also remove any learned data for this surah\n        if (settings.learnedVerses[surahId]) {\n            delete settings.learnedVerses[surahId];\n        }\n        pruneSurahArtifacts(surahId);\n    }\n    settings.skippedSurahs = Array.from(current).sort((a, b)=>a - b);\n    saveSettings(settings);\n}\n// ========================================\n// Learned Verses Helpers\n// ========================================\nfunction isVerseLearned(surahId, ayahId) {\n    var _settings_learnedVerses_surahId;\n    const settings = getSettings();\n    return ((_settings_learnedVerses_surahId = settings.learnedVerses[surahId]) === null || _settings_learnedVerses_surahId === void 0 ? void 0 : _settings_learnedVerses_surahId.includes(ayahId)) || false;\n}\nfunction toggleVerseLearned(surahId, ayahId) {\n    const settings = getSettings();\n    const surahKey = surahId.toString();\n    const current = settings.learnedVerses[surahKey] || [];\n    if (current.includes(ayahId)) {\n        settings.learnedVerses[surahKey] = current.filter((v)=>v !== ayahId);\n        if (settings.learnedVerses[surahKey].length === 0) {\n            delete settings.learnedVerses[surahKey];\n        }\n    } else {\n        settings.learnedVerses[surahKey] = [\n            ...current,\n            ayahId\n        ].sort((a, b)=>a - b);\n    }\n    saveSettings(settings);\n    syncMemoryNodesWithLearned();\n}\nfunction toggleSurahLearned(surahId) {\n    const settings = getSettings();\n    const surah = _quranData__WEBPACK_IMPORTED_MODULE_0__.SURAHS.find((s)=>s.id === surahId);\n    if (!surah) return;\n    const surahKey = surahId.toString();\n    const current = settings.learnedVerses[surahKey] || [];\n    if (current.length === surah.verseCount) {\n        delete settings.learnedVerses[surahKey];\n    } else {\n        settings.learnedVerses[surahKey] = Array.from({\n            length: surah.verseCount\n        }, (_, i)=>i + 1);\n    }\n    saveSettings(settings);\n    syncMemoryNodesWithLearned();\n}\nfunction getSurahLearnedStatus(surahId) {\n    var _settings_learnedVerses_surahId;\n    const settings = getSettings();\n    const surah = _quranData__WEBPACK_IMPORTED_MODULE_0__.SURAHS.find((s)=>s.id === surahId);\n    if (!surah) return {\n        learned: 0,\n        total: 0\n    };\n    const learned = ((_settings_learnedVerses_surahId = settings.learnedVerses[surahId]) === null || _settings_learnedVerses_surahId === void 0 ? void 0 : _settings_learnedVerses_surahId.length) || 0;\n    return {\n        learned,\n        total: surah.verseCount\n    };\n}\nfunction getTotalLearnedVerses() {\n    const settings = getSettings();\n    return Object.values(settings.learnedVerses).reduce((sum, verses)=>sum + verses.length, 0);\n}\nfunction getLearnedVersesInPart(part) {\n    const settings = getSettings();\n    const result = [];\n    _quranData__WEBPACK_IMPORTED_MODULE_0__.SURAHS.filter((s)=>s.part === part).forEach((surah)=>{\n        const verses = settings.learnedVerses[surah.id] || [];\n        verses.forEach((ayahId)=>{\n            result.push({\n                surahId: surah.id,\n                ayahId\n            });\n        });\n    });\n    return result;\n}\nfunction getMemoryNodes() {\n    return getFromCache(STORAGE_KEYS.MEMORY_NODES, []);\n}\nfunction saveMemoryNodes(nodes) {\n    saveToCacheAndStore(STORAGE_KEYS.MEMORY_NODES, nodes);\n}\nfunction getDueNodes() {\n    const today = new Date().toISOString().split(\"T\")[0];\n    const settings = getSettings();\n    const skips = new Set(settings.skippedSurahs || []);\n    const suspended = getSuspendedAnchors();\n    return getMemoryNodes().filter((n)=>n.scheduler.dueDate <= today).filter((n)=>!n.surahId || !skips.has(n.surahId)).filter((n)=>!isNodeSuspended(n, suspended));\n}\nfunction updateMemoryNode(node) {\n    const nodes = getMemoryNodes();\n    const index = nodes.findIndex((n)=>n.id === node.id);\n    if (index >= 0) {\n        nodes[index] = node;\n    } else {\n        nodes.push(node);\n    }\n    saveMemoryNodes(nodes);\n}\nfunction createNewScheduler() {\n    const today = new Date().toISOString().split(\"T\")[0];\n    return {\n        interval: 0,\n        repetition: 0,\n        easeFactor: 2.5,\n        dueDate: today,\n        lastReview: \"\"\n    };\n}\n// Sync memory nodes with learned verses - create nodes for learned verses\nfunction syncMemoryNodesWithLearned() {\n    let forceFullReset = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : false;\n    const settings = getSettings();\n    const nodes = forceFullReset ? [] : getMemoryNodes();\n    // Group verses into segments of 5\n    Object.entries(settings.learnedVerses).forEach((param)=>{\n        let [surahIdStr, verses] = param;\n        const surahId = parseInt(surahIdStr);\n        if (verses.length === 0) return;\n        // Create segments of 5 verses\n        const sortedVerses = [\n            ...verses\n        ].sort((a, b)=>a - b);\n        let segmentStart = sortedVerses[0];\n        let segmentEnd = segmentStart;\n        for(let i = 1; i <= sortedVerses.length; i++){\n            const isContiguous = i < sortedVerses.length && sortedVerses[i] === segmentEnd + 1;\n            const segmentSize = segmentEnd - segmentStart + 1;\n            if (!isContiguous || segmentSize >= 5 || i === sortedVerses.length) {\n                // Create node for this segment if it doesn't exist\n                const nodeId = \"verse-\".concat(surahId, \"-\").concat(segmentStart, \"-\").concat(segmentEnd);\n                const exists = nodes.some((n)=>n.id === nodeId);\n                if (!exists || forceFullReset) {\n                    const newNode = {\n                        id: nodeId,\n                        type: \"verse\",\n                        surahId,\n                        startVerse: segmentStart,\n                        endVerse: segmentEnd,\n                        scheduler: createNewScheduler()\n                    };\n                    if (forceFullReset) {\n                        nodes.push(newNode);\n                    } else if (!exists) {\n                        nodes.push(newNode);\n                    }\n                }\n                if (i < sortedVerses.length) {\n                    segmentStart = sortedVerses[i];\n                    segmentEnd = segmentStart;\n                }\n            } else {\n                segmentEnd = sortedVerses[i];\n            }\n        }\n    });\n    if (forceFullReset) {\n        // Also sync mindmaps\n        const mindmaps = getMindMaps();\n        Object.values(mindmaps).forEach((mm)=>{\n            if (mm.isComplete) {\n                nodes.push({\n                    id: \"mindmap-\".concat(mm.surahId),\n                    type: \"mindmap\",\n                    surahId: mm.surahId,\n                    scheduler: createNewScheduler()\n                });\n            }\n        });\n        // Also sync part mindmaps\n        const partMindmaps = getPartMindMaps();\n        Object.values(partMindmaps).forEach((pmm)=>{\n            if (pmm.isComplete) {\n                nodes.push({\n                    id: \"part-mindmap-\".concat(pmm.partId),\n                    type: \"part_mindmap\",\n                    partId: pmm.partId,\n                    scheduler: createNewScheduler()\n                });\n            }\n        });\n    }\n    saveMemoryNodes(nodes);\n}\n// SM-2 Algorithm\nfunction sm2(grade, state) {\n    let { interval, repetition, easeFactor } = state;\n    if (grade < 3) {\n        repetition = 0;\n        interval = 1;\n    } else {\n        if (repetition === 0) interval = 1;\n        else if (repetition === 1) interval = 6;\n        else interval = Math.round(interval * easeFactor);\n        repetition++;\n    }\n    easeFactor = Math.max(1.3, easeFactor + (0.1 - (5 - grade) * (0.08 + (5 - grade) * 0.02)));\n    const dueDate = new Date();\n    dueDate.setDate(dueDate.getDate() + interval);\n    return {\n        interval,\n        repetition,\n        easeFactor: Math.round(easeFactor * 100) / 100,\n        dueDate: dueDate.toISOString().split(\"T\")[0],\n        lastReview: new Date().toISOString().split(\"T\")[0]\n    };\n}\nfunction postponeNode(node) {\n    const tomorrow = new Date();\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    return {\n        ...node,\n        scheduler: {\n            ...node.scheduler,\n            dueDate: tomorrow.toISOString().split(\"T\")[0],\n            lastReview: new Date().toISOString().split(\"T\")[0]\n        }\n    };\n}\nfunction getMindMaps() {\n    return getFromCache(STORAGE_KEYS.MINDMAPS, {});\n}\nfunction getMindMap(surahId) {\n    const maps = getMindMaps();\n    return maps[surahId] || {\n        surahId,\n        imageUrl: null,\n        anchors: [],\n        isComplete: false\n    };\n}\nfunction saveMindMap(mindmap) {\n    const maps = getMindMaps();\n    maps[mindmap.surahId] = mindmap;\n    saveToCacheAndStore(STORAGE_KEYS.MINDMAPS, maps);\n    // Create/update memory node for mindmap if complete\n    if (mindmap.isComplete) {\n        const nodes = getMemoryNodes();\n        const nodeId = \"mindmap-\".concat(mindmap.surahId);\n        const exists = nodes.some((n)=>n.id === nodeId);\n        if (!exists) {\n            nodes.push({\n                id: nodeId,\n                type: \"mindmap\",\n                surahId: mindmap.surahId,\n                scheduler: createNewScheduler()\n            });\n            saveMemoryNodes(nodes);\n        }\n    }\n}\nfunction getPartMindMaps() {\n    return getFromCache(STORAGE_KEYS.PART_MINDMAPS, {});\n}\nfunction getPartMindMap(partId) {\n    const maps = getPartMindMaps();\n    return maps[partId] || {\n        partId,\n        imageUrl: null,\n        description: \"\",\n        isComplete: false\n    };\n}\nfunction savePartMindMap(mindmap) {\n    const maps = getPartMindMaps();\n    maps[mindmap.partId] = mindmap;\n    saveToCacheAndStore(STORAGE_KEYS.PART_MINDMAPS, maps);\n    // Create memory node for part mindmap if complete\n    if (mindmap.isComplete) {\n        const nodes = getMemoryNodes();\n        const nodeId = \"part-mindmap-\".concat(mindmap.partId);\n        const exists = nodes.some((n)=>n.id === nodeId);\n        if (!exists) {\n            nodes.push({\n                id: nodeId,\n                type: \"part_mindmap\",\n                partId: mindmap.partId,\n                scheduler: createNewScheduler()\n            });\n            saveMemoryNodes(nodes);\n        }\n    }\n}\nfunction getListeningProgress(partId) {\n    const map = getFromCache(STORAGE_KEYS.LISTENING_PROGRESS, {});\n    return map[partId] || {\n        partId,\n        currentVerseIndex: 0\n    };\n}\nfunction saveListeningProgress(partId, currentVerseIndex) {\n    const map = getFromCache(STORAGE_KEYS.LISTENING_PROGRESS, {});\n    map[partId] = {\n        partId,\n        currentVerseIndex\n    };\n    saveToCacheAndStore(STORAGE_KEYS.LISTENING_PROGRESS, map);\n}\nfunction getListeningStats() {\n    return getFromCache(STORAGE_KEYS.LISTENING_STATS, {});\n}\nfunction getListeningStatsForSurah(surahId) {\n    const stats = getListeningStats();\n    return stats[surahId] || {\n        surahId,\n        totalMinutes: 0,\n        lastListened: \"\"\n    };\n}\nfunction addListeningTime(surahId, minutes) {\n    const stats = getListeningStats();\n    const current = stats[surahId] || {\n        surahId,\n        totalMinutes: 0,\n        lastListened: \"\"\n    };\n    current.totalMinutes += minutes;\n    current.lastListened = new Date().toISOString();\n    stats[surahId] = current;\n    saveToCacheAndStore(STORAGE_KEYS.LISTENING_STATS, stats);\n}\n// ========================================\n// Listening Complete Tracking\n// ========================================\nfunction getListeningCompletedToday() {\n    const stored = getFromCache(STORAGE_KEYS.LISTENING_COMPLETE, null);\n    if (!stored) return false;\n    const today = new Date().toISOString().split(\"T\")[0];\n    return stored === today;\n}\nfunction markListeningComplete() {\n    const today = new Date().toISOString().split(\"T\")[0];\n    saveToCacheAndStore(STORAGE_KEYS.LISTENING_COMPLETE, today);\n}\nfunction getReviewErrors() {\n    return getFromCache(STORAGE_KEYS.REVIEW_ERRORS, []);\n}\nfunction saveReviewError(error) {\n    const errors = getReviewErrors();\n    errors.push(error);\n    // Keep only last 100 errors\n    const trimmed = errors.slice(-100);\n    saveToCacheAndStore(STORAGE_KEYS.REVIEW_ERRORS, trimmed);\n}\nfunction removeReviewError(id) {\n    const errors = getReviewErrors();\n    const remaining = errors.filter((e)=>e.id !== id);\n    saveToCacheAndStore(STORAGE_KEYS.REVIEW_ERRORS, remaining);\n}\nfunction getErrorsByAnchor() {\n    const errors = getReviewErrors();\n    const mindmaps = getMindMaps();\n    const anchorCounts = {};\n    errors.filter((e)=>e.grade < 3).forEach((error)=>{\n        if (error.surahId && error.startVerse && error.endVerse) {\n            const mindmap = mindmaps[error.surahId];\n            if (mindmap) {\n                const anchor = mindmap.anchors.find((a)=>a.startVerse <= error.startVerse && a.endVerse >= error.endVerse);\n                if (anchor) {\n                    const key = \"\".concat(error.surahId, \"-\").concat(anchor.id);\n                    if (!anchorCounts[key]) {\n                        anchorCounts[key] = {\n                            label: anchor.label,\n                            count: 0,\n                            surahId: error.surahId,\n                            anchorId: anchor.id,\n                            startVerse: anchor.startVerse,\n                            endVerse: anchor.endVerse\n                        };\n                    }\n                    anchorCounts[key].count++;\n                }\n            }\n        }\n    });\n    return Object.values(anchorCounts).sort((a, b)=>b.count - a.count);\n}\n// ========================================\n// Cycle Management\n// ========================================\nfunction getCycleStart() {\n    let stored = getFromCache(STORAGE_KEYS.CYCLE_START, null);\n    if (!stored) {\n        stored = new Date().toISOString().split(\"T\")[0];\n        saveToCacheAndStore(STORAGE_KEYS.CYCLE_START, stored);\n    }\n    return stored;\n}\nfunction setCycleStart(date) {\n    saveToCacheAndStore(STORAGE_KEYS.CYCLE_START, date);\n}\nfunction getCurrentDayInCycle() {\n    const start = new Date(getCycleStart());\n    const today = new Date();\n    const diff = Math.floor((today.getTime() - start.getTime()) / (1000 * 60 * 60 * 24));\n    const settings = getSettings();\n    return diff % settings.completionDays;\n}\nfunction setSurahMaturity(surahId, level) {\n    const nodes = getMemoryNodes();\n    const now = new Date();\n    const updatedNodes = nodes.map((node)=>{\n        if (node.surahId !== surahId || node.type !== \"verse\" && node.type !== \"mindmap\") {\n            return node;\n        }\n        let interval = 1;\n        let efactor = 2.5;\n        switch(level){\n            case \"reset\":\n                interval = 1;\n                break;\n            case \"medium\":\n                interval = 14;\n                break;\n            case \"strong\":\n                interval = 30;\n                break;\n            case \"mastered\":\n                interval = 90;\n                break;\n        }\n        // Add jitter: +/- 20%\n        if (level !== \"reset\") {\n            const jitter = interval * 0.2;\n            interval = Math.round(interval + (Math.random() * jitter * 2 - jitter));\n        }\n        const dueDate = new Date(now);\n        dueDate.setDate(dueDate.getDate() + interval);\n        return {\n            ...node,\n            scheduler: {\n                ...node.scheduler,\n                interval,\n                easeFactor: efactor,\n                dueDate: dueDate.toISOString()\n            }\n        };\n    });\n    saveMemoryNodes(updatedNodes);\n}\nfunction resetAllMaturity() {\n    // 1. Clear all memory nodes\n    saveToCacheAndStore(STORAGE_KEYS.MEMORY_NODES, []);\n    // 2. Clear all review errors\n    saveToCacheAndStore(STORAGE_KEYS.REVIEW_ERRORS, []);\n    // 3. Regenerate nodes based on currently learned surahs and completed mindmaps\n    syncMemoryNodesWithLearned(true);\n}\nfunction getSuspendedAnchors() {\n    let threshold = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 3;\n    return getErrorsByAnchor().filter((e)=>e.count >= threshold && e.surahId && e.anchorId).map((e)=>({\n            anchorId: e.anchorId,\n            label: e.label,\n            surahId: e.surahId,\n            count: e.count,\n            startVerse: e.startVerse,\n            endVerse: e.endVerse\n        }));\n}\nfunction clearAnchorIssues(surahId, anchorId) {\n    const remaining = getReviewErrors().filter((err)=>!(err.surahId === surahId && err.anchorId === anchorId));\n    if (false) {}\n    localStorage.setItem(STORAGE_KEYS.REVIEW_ERRORS, JSON.stringify(remaining));\n}\nfunction findAnchorForRange(surahId, startVerse, endVerse) {\n    const mindmap = getMindMap(surahId);\n    if (!startVerse || !endVerse) return undefined;\n    return mindmap.anchors.find((a)=>a.startVerse <= startVerse && a.endVerse >= endVerse);\n}\nfunction getCustomMutashabihat() {\n    return getFromCache(STORAGE_KEYS.CUSTOM_MUTASHABIHAT, []);\n}\nfunction saveCustomMutashabih(mut) {\n    const all = getCustomMutashabihat();\n    const existingIdx = all.findIndex((m)=>m.id === mut.id);\n    if (existingIdx >= 0) {\n        all[existingIdx] = mut;\n    } else {\n        all.push(mut);\n    }\n    saveToCacheAndStore(STORAGE_KEYS.CUSTOM_MUTASHABIHAT, all);\n}\nfunction deleteCustomMutashabih(id) {\n    const all = getCustomMutashabihat().filter((m)=>m.id !== id);\n    saveToCacheAndStore(STORAGE_KEYS.CUSTOM_MUTASHABIHAT, all);\n}\nfunction getMutashabihatDecisions() {\n    return getFromCache(STORAGE_KEYS.MUTASHABIHAT_DECISIONS, {});\n}\nfunction setMutashabihatDecision(absoluteAyah, decision, phraseId) {\n    const decisions = getMutashabihatDecisions();\n    const key = phraseId ? \"\".concat(absoluteAyah, \"-\").concat(phraseId) : absoluteAyah.toString();\n    decisions[key] = decision;\n    saveToCacheAndStore(STORAGE_KEYS.MUTASHABIHAT_DECISIONS, decisions);\n}\nfunction resetMutashabihatDecisions(absoluteAyat) {\n    const decisions = getMutashabihatDecisions();\n    const keysToDelete = Object.keys(decisions).filter((key)=>{\n        const abs = parseInt(key.split(\"-\")[0], 10);\n        return absoluteAyat.includes(abs);\n    });\n    if (keysToDelete.length === 0) return;\n    keysToDelete.forEach((key)=>delete decisions[key]);\n    saveToCacheAndStore(STORAGE_KEYS.MUTASHABIHAT_DECISIONS, decisions);\n}\nfunction bulkSetSurahStatus(surahIds, status) {\n    const settings = getSettings();\n    const allSurahs = _quranData__WEBPACK_IMPORTED_MODULE_0__.SURAHS;\n    surahIds.forEach((id)=>{\n        const surah = allSurahs.find((s)=>s.id === id);\n        if (!surah) return;\n        const surahKey = id.toString();\n        // Reset state for this surah first\n        delete settings.learnedVerses[surahKey];\n        settings.skippedSurahs = (settings.skippedSurahs || []).filter((sId)=>sId !== id);\n        if (status === \"learned\") {\n            const verseIds = Array.from({\n                length: surah.verseCount\n            }, (_, i)=>i + 1);\n            settings.learnedVerses[surahKey] = verseIds;\n        } else if (status === \"skipped\") {\n            settings.skippedSurahs = [\n                ...settings.skippedSurahs || [],\n                id\n            ];\n            pruneSurahArtifacts(id);\n        }\n    // 'new' status is already handled by the resets above\n    });\n    if (settings.skippedSurahs) {\n        settings.skippedSurahs.sort((a, b)=>a - b);\n    }\n    saveSettings(settings);\n}\nfunction pruneSurahArtifacts(surahId) {\n    // Remove memory nodes for this surah\n    const nodes = getMemoryNodes().filter((n)=>n.surahId !== surahId);\n    saveMemoryNodes(nodes);\n    // Remove surah mindmap\n    const maps = getMindMaps();\n    if (maps[surahId]) {\n        delete maps[surahId];\n        saveToCacheAndStore(STORAGE_KEYS.MINDMAPS, maps);\n    }\n    // Remove review errors\n    const remainingErrors = getReviewErrors().filter((err)=>err.surahId !== surahId);\n    saveToCacheAndStore(STORAGE_KEYS.REVIEW_ERRORS, remainingErrors);\n}\nfunction isNodeSuspended(node, issues) {\n    if (!node.surahId) return false;\n    const relatedIssues = issues.filter((i)=>i.surahId === node.surahId);\n    if (relatedIssues.length === 0) return false;\n    if (node.type === \"mindmap\") return true;\n    if (node.type === \"verse\") {\n        const anchor = findAnchorForRange(node.surahId, node.startVerse, node.endVerse);\n        return anchor ? relatedIssues.some((i)=>i.anchorId === anchor.id) : false;\n    }\n    return false;\n}\nfunction exportBackup() {\n    return {\n        settings: getSettings(),\n        memoryNodes: getMemoryNodes(),\n        mindmaps: getMindMaps(),\n        partMindmaps: getPartMindMaps(),\n        listeningStats: getListeningStats(),\n        listeningProgress: getFromCache(STORAGE_KEYS.LISTENING_PROGRESS, {}),\n        reviewErrors: getReviewErrors(),\n        mutashabihatDecisions: getMutashabihatDecisions(),\n        customMutashabihat: getCustomMutashabihat(),\n        cycleStart: getCycleStart(),\n        listeningComplete: getFromCache(STORAGE_KEYS.LISTENING_COMPLETE, null),\n        exportedAt: new Date().toISOString()\n    };\n}\nfunction importBackup(data) {\n    if (data.settings) saveSettings(data.settings);\n    if (data.memoryNodes) saveMemoryNodes(data.memoryNodes);\n    if (data.mindmaps) {\n        saveToCacheAndStore(STORAGE_KEYS.MINDMAPS, data.mindmaps);\n    }\n    if (data.partMindmaps) {\n        saveToCacheAndStore(STORAGE_KEYS.PART_MINDMAPS, data.partMindmaps);\n    }\n    if (data.listeningStats) {\n        saveToCacheAndStore(STORAGE_KEYS.LISTENING_STATS, data.listeningStats);\n    }\n    if (data.listeningProgress) {\n        saveToCacheAndStore(STORAGE_KEYS.LISTENING_PROGRESS, data.listeningProgress);\n    }\n    if (data.reviewErrors) {\n        saveToCacheAndStore(STORAGE_KEYS.REVIEW_ERRORS, data.reviewErrors);\n    }\n    if (data.mutashabihatDecisions) {\n        saveToCacheAndStore(STORAGE_KEYS.MUTASHABIHAT_DECISIONS, data.mutashabihatDecisions);\n    }\n    if (data.customMutashabihat) {\n        saveToCacheAndStore(STORAGE_KEYS.CUSTOM_MUTASHABIHAT, data.customMutashabihat);\n    }\n    if (data.cycleStart) setCycleStart(data.cycleStart);\n    if (data.listeningComplete) saveToCacheAndStore(STORAGE_KEYS.LISTENING_COMPLETE, data.listeningComplete);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9saWIvc3RvcmFnZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSwyQ0FBMkM7QUFDM0MsdURBQXVEO0FBQ3ZELDJDQUEyQztBQUVOO0FBRWM7QUFFbkQsMkNBQTJDO0FBQzNDLHFDQUFxQztBQUNyQywyQ0FBMkM7QUFFM0MsTUFBTUksY0FBYyxLQUFrQixHQUFjRCx1REFBV0EsQ0FBQyxnQkFBZ0IscUJBQXFCRSxDQUFTQTtBQUU5Rzs7Q0FFQyxHQUNELGVBQWVDO0lBQ1gsSUFBSSxNQUFrQixJQUFlLENBQUNGLGFBQWE7SUFFbkQsTUFBTUcsZ0JBQWdCO0lBQ3RCLElBQUlDLGFBQWFDLE9BQU8sQ0FBQ0YsZ0JBQWdCO0lBRXpDLEtBQUssTUFBTUcsT0FBT0MsT0FBT0MsTUFBTSxDQUFDQyxjQUFlO1FBQzNDLE1BQU1DLFFBQVFOLGFBQWFDLE9BQU8sQ0FBQ0M7UUFDbkMsSUFBSUksT0FBTztZQUNQLElBQUk7Z0JBQ0EsTUFBTVosK0NBQUdBLENBQUNRLEtBQUtLLEtBQUtDLEtBQUssQ0FBQ0YsUUFBUVY7WUFDdEMsRUFBRSxPQUFPYSxHQUFHO2dCQUNSQyxRQUFRQyxLQUFLLENBQUMsNEJBQWdDLE9BQUpULEtBQUksTUFBSU87WUFDdEQ7UUFDSjtJQUNKO0lBRUFULGFBQWFZLE9BQU8sQ0FBQ2IsZUFBZTtJQUNwQ1csUUFBUUcsR0FBRyxDQUFDO0FBQ2hCO0FBRUEsNEJBQTRCO0FBQzVCLElBQUksSUFBa0IsRUFBYTtJQUMvQmY7QUFDSjtBQUVBOzs7Q0FHQyxHQUNELE1BQU1nQixlQUF1QyxDQUFDO0FBRTlDLGVBQWVDO0lBQ1gsSUFBSSxNQUFrQixJQUFlLENBQUNuQixhQUFhO0lBQ25ELEtBQUssTUFBTU0sT0FBT0MsT0FBT0MsTUFBTSxDQUFDQyxjQUFlO1FBQzNDUyxZQUFZLENBQUNaLElBQUksR0FBRyxNQUFNVCwr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QUFLTixxQkFBcUIsRUFBRTtRQUM1QnJOLG9CQUFvQmQsYUFBYTBCLHNCQUFzQixFQUFFK00sS0FBS04scUJBQXFCO0lBQ3ZGO0lBQ0EsSUFBSU0sS0FBS0wsa0JBQWtCLEVBQUU7UUFDekJ0TixvQkFBb0JkLGFBQWEyQixtQkFBbUIsRUFBRThNLEtBQUtMLGtCQUFrQjtJQUNqRjtJQUNBLElBQUlLLEtBQUtKLFVBQVUsRUFBRXJELGNBQWN5RCxLQUFLSixVQUFVO0lBQ2xELElBQUlJLEtBQUtILGlCQUFpQixFQUFFeE4sb0JBQW9CZCxhQUFhd0Isa0JBQWtCLEVBQUVpTixLQUFLSCxpQkFBaUI7QUFDM0ciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL2xpYi9zdG9yYWdlLnRzP2FmZTgiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU3RvcmFnZSBTZXJ2aWNlIC0gV2l0aCBQYXJ0IE1pbmRtYXBzICYgUmV2aWV3IEVycm9yc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgeyBTVVJBSFMgfSBmcm9tICcuL3F1cmFuRGF0YSc7XG5pbXBvcnQgeyBRdXJhblBhcnQsIGdldE1hdHVyaXR5VGhyZXNob2xkIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBnZXQsIHNldCwgY3JlYXRlU3RvcmUgfSBmcm9tICdpZGIta2V5dmFsJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU3RvcmFnZSBFbmdpbmUgTWlncmF0aW9uICYgSGVscGVyc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBjdXN0b21TdG9yZSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gY3JlYXRlU3RvcmUoJ3F1cmFuLWFwcC1kYicsICdxdXJhbi1hcHAtc3RvcmUnKSA6IHVuZGVmaW5lZDtcblxuLyoqXG4gKiBNaWdyYXRpb24gaGVscGVyIHRvIG1vdmUgZGF0YSBmcm9tIGxvY2FsU3RvcmFnZSB0byBJbmRleGVkREIgb25jZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gbWlncmF0ZUZyb21Mb2NhbFN0b3JhZ2UoKSB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICFjdXN0b21TdG9yZSkgcmV0dXJuO1xuICAgIFxuICAgIGNvbnN0IG1pZ3JhdGlvbkZsYWcgPSAncXVyYW4tYXBwLW1pZ3JhdGVkLXRvLWlkYic7XG4gICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKG1pZ3JhdGlvbkZsYWcpKSByZXR1cm47XG5cbiAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3QudmFsdWVzKFNUT1JBR0VfS0VZUykpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgc2V0KGtleSwgSlNPTi5wYXJzZSh2YWx1ZSksIGN1c3RvbVN0b3JlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBNaWdyYXRpb24gZmFpbGVkIGZvciBrZXkgJHtrZXl9OmAsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKG1pZ3JhdGlvbkZsYWcsICd0cnVlJyk7XG4gICAgY29uc29sZS5sb2coJ1N1Y2Nlc3NmdWxseSBtaWdyYXRlZCBkYXRhIGZyb20gbG9jYWxTdG9yYWdlIHRvIEluZGV4ZWREQicpO1xufVxuXG4vLyBJbml0aWFsIG1pZ3JhdGlvbiB0cmlnZ2VyXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBtaWdyYXRlRnJvbUxvY2FsU3RvcmFnZSgpO1xufVxuXG4vKipcbiAqIEdsb2JhbCBjYWNoZSB0byBrZWVwIHN5bmNocm9ub3VzIGFjY2VzcyBmb3IgZXhpc3RpbmcgVUkgd2hpbGUgcGVyc2lzdGluZyBhc3luY2hyb25vdXNseS5cbiAqIFRoaXMgZW5zdXJlcyB0aGUgVUkgcmVtYWlucyBzbmFwcHkgd2hpbGUgZGF0YSBpcyBzYWZlbHkgc3RvcmVkIGluIEluZGV4ZWREQi5cbiAqL1xuY29uc3Qgc3RvcmFnZUNhY2hlOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0ge307XG5cbmFzeW5jIGZ1bmN0aW9uIGxvYWRJbnRvQ2FjaGUoKSB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICFjdXN0b21TdG9yZSkgcmV0dXJuO1xuICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC52YWx1ZXMoU1RPUkFHRV9LRVlTKSkge1xuICAgICAgICBzdG9yYWdlQ2FjaGVba2V5XSA9IGF3YWl0IGdldChrZXksIGN1c3RvbVN0b3JlKTtcbiAgICB9XG59XG5cbi8vIFN0YXJ0IGxvYWRpbmcgY2FjaGVcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxvYWRJbnRvQ2FjaGUoKTtcbn1cblxuZnVuY3Rpb24gZ2V0RnJvbUNhY2hlPFQ+KGtleTogc3RyaW5nLCBkZWZhdWx0VmFsdWU6IFQpOiBUIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgY29uc3QgY2FjaGVkID0gc3RvcmFnZUNhY2hlW2tleV07XG4gICAgcmV0dXJuIGNhY2hlZCAhPT0gdW5kZWZpbmVkID8gY2FjaGVkIDogZGVmYXVsdFZhbHVlO1xufVxuXG5mdW5jdGlvbiBzYXZlVG9DYWNoZUFuZFN0b3JlKGtleTogc3RyaW5nLCB2YWx1ZTogYW55KSB7XG4gICAgc3RvcmFnZUNhY2hlW2tleV0gPSB2YWx1ZTtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgY3VzdG9tU3RvcmUpIHtcbiAgICAgICAgc2V0KGtleSwgdmFsdWUsIGN1c3RvbVN0b3JlKS5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIHBlcnNpc3QgJHtrZXl9OmAsIGVycikpO1xuICAgIH1cbn1cblxuY29uc3QgU1RPUkFHRV9LRVlTID0ge1xuICAgIFNFVFRJTkdTOiAncXVyYW4tYXBwLXNldHRpbmdzJyxcbiAgICBNRU1PUllfTk9ERVM6ICdxdXJhbi1hcHAtbWVtb3J5LW5vZGVzJyxcbiAgICBNSU5ETUFQUzogJ3F1cmFuLWFwcC1taW5kbWFwcycsXG4gICAgUEFSVF9NSU5ETUFQUzogJ3F1cmFuLWFwcC1wYXJ0LW1pbmRtYXBzJyxcbiAgICBMSVNURU5JTkdfUFJPR1JFU1M6ICdxdXJhbi1hcHAtbGlzdGVuaW5nLXByb2dyZXNzJyxcbiAgICBMSVNURU5JTkdfU1RBVFM6ICdxdXJhbi1hcHAtbGlzdGVuaW5nLXN0YXRzJyxcbiAgICBDWUNMRV9TVEFSVDogJ3F1cmFuLWFwcC1jeWNsZS1zdGFydCcsXG4gICAgTElTVEVOSU5HX0NPTVBMRVRFOiAncXVyYW4tYXBwLWxpc3RlbmluZy1jb21wbGV0ZScsXG4gICAgUkVWSUVXX0VSUk9SUzogJ3F1cmFuLWFwcC1yZXZpZXctZXJyb3JzJyxcbiAgICBNVVRBU0hBQklIQVRfREVDSVNJT05TOiAncXVyYW4tYXBwLW11dGFzaGFiaWhhdC1kZWNpc2lvbnMnLFxuICAgIENVU1RPTV9NVVRBU0hBQklIQVQ6ICdxdXJhbi1hcHAtY3VzdG9tLW11dGFzaGFiaWhhdCcsXG59O1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTZXR0aW5nc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIEFwcFNldHRpbmdzIHtcbiAgICBjb21wbGV0aW9uRGF5czogbnVtYmVyO1xuICAgIGFjdGl2ZVBhcnQ6IFF1cmFuUGFydDtcbiAgICBsZWFybmVkVmVyc2VzOiB7IFtzdXJhaElkOiBzdHJpbmddOiBudW1iZXJbXSB9O1xuICAgIHNraXBwZWRTdXJhaHM/OiBudW1iZXJbXTtcbiAgICBsYXN0U3luY2VkQXQ/OiBzdHJpbmc7XG59XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEFwcFNldHRpbmdzID0ge1xuICAgIGNvbXBsZXRpb25EYXlzOiAzMCxcbiAgICBhY3RpdmVQYXJ0OiA0LFxuICAgIGxlYXJuZWRWZXJzZXM6IHt9LFxuICAgIHNraXBwZWRTdXJhaHM6IFtdLFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNldHRpbmdzKCk6IEFwcFNldHRpbmdzIHtcbiAgICByZXR1cm4gZ2V0RnJvbUNhY2hlKFNUT1JBR0VfS0VZUy5TRVRUSU5HUywgREVGQVVMVF9TRVRUSU5HUyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYXZlU2V0dGluZ3Moc2V0dGluZ3M6IEFwcFNldHRpbmdzKTogdm9pZCB7XG4gICAgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuU0VUVElOR1MsIHNldHRpbmdzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVNldHRpbmc8SyBleHRlbmRzIGtleW9mIEFwcFNldHRpbmdzPihrZXk6IEssIHZhbHVlOiBBcHBTZXR0aW5nc1tLXSk6IHZvaWQge1xuICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0U2V0dGluZ3MoKTtcbiAgICBzZXR0aW5nc1trZXldID0gdmFsdWU7XG4gICAgc2F2ZVNldHRpbmdzKHNldHRpbmdzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3VyYWhTa2lwcGVkKHN1cmFoSWQ6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0U2V0dGluZ3MoKTtcbiAgICByZXR1cm4gc2V0dGluZ3Muc2tpcHBlZFN1cmFocz8uaW5jbHVkZXMoc3VyYWhJZCkgfHwgZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVTdXJhaFNraXBwZWQoc3VyYWhJZDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3Qgc2V0dGluZ3MgPSBnZXRTZXR0aW5ncygpO1xuICAgIGNvbnN0IGN1cnJlbnQgPSBuZXcgU2V0KHNldHRpbmdzLnNraXBwZWRTdXJhaHMgfHwgW10pO1xuICAgIGlmIChjdXJyZW50LmhhcyhzdXJhaElkKSkge1xuICAgICAgICBjdXJyZW50LmRlbGV0ZShzdXJhaElkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjdXJyZW50LmFkZChzdXJhaElkKTtcbiAgICAgICAgLy8gQWxzbyByZW1vdmUgYW55IGxlYXJuZWQgZGF0YSBmb3IgdGhpcyBzdXJhaFxuICAgICAgICBpZiAoc2V0dGluZ3MubGVhcm5lZFZlcnNlc1tzdXJhaElkXSkge1xuICAgICAgICAgICAgZGVsZXRlIHNldHRpbmdzLmxlYXJuZWRWZXJzZXNbc3VyYWhJZF07XG4gICAgICAgIH1cbiAgICAgICAgcHJ1bmVTdXJhaEFydGlmYWN0cyhzdXJhaElkKTtcbiAgICB9XG4gICAgc2V0dGluZ3Muc2tpcHBlZFN1cmFocyA9IEFycmF5LmZyb20oY3VycmVudCkuc29ydCgoYSwgYikgPT4gYSAtIGIpO1xuICAgIHNhdmVTZXR0aW5ncyhzZXR0aW5ncyk7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIExlYXJuZWQgVmVyc2VzIEhlbHBlcnNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmVyc2VMZWFybmVkKHN1cmFoSWQ6IG51bWJlciwgYXlhaElkOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBjb25zdCBzZXR0aW5ncyA9IGdldFNldHRpbmdzKCk7XG4gICAgcmV0dXJuIHNldHRpbmdzLmxlYXJuZWRWZXJzZXNbc3VyYWhJZF0/LmluY2x1ZGVzKGF5YWhJZCkgfHwgZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVWZXJzZUxlYXJuZWQoc3VyYWhJZDogbnVtYmVyLCBheWFoSWQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0U2V0dGluZ3MoKTtcbiAgICBjb25zdCBzdXJhaEtleSA9IHN1cmFoSWQudG9TdHJpbmcoKTtcbiAgICBjb25zdCBjdXJyZW50ID0gc2V0dGluZ3MubGVhcm5lZFZlcnNlc1tzdXJhaEtleV0gfHwgW107XG5cbiAgICBpZiAoY3VycmVudC5pbmNsdWRlcyhheWFoSWQpKSB7XG4gICAgICAgIHNldHRpbmdzLmxlYXJuZWRWZXJzZXNbc3VyYWhLZXldID0gY3VycmVudC5maWx0ZXIodiA9PiB2ICE9PSBheWFoSWQpO1xuICAgICAgICBpZiAoc2V0dGluZ3MubGVhcm5lZFZlcnNlc1tzdXJhaEtleV0ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBkZWxldGUgc2V0dGluZ3MubGVhcm5lZFZlcnNlc1tzdXJhaEtleV07XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBzZXR0aW5ncy5sZWFybmVkVmVyc2VzW3N1cmFoS2V5XSA9IFsuLi5jdXJyZW50LCBheWFoSWRdLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgICB9XG5cbiAgICBzYXZlU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgIHN5bmNNZW1vcnlOb2Rlc1dpdGhMZWFybmVkKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVTdXJhaExlYXJuZWQoc3VyYWhJZDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3Qgc2V0dGluZ3MgPSBnZXRTZXR0aW5ncygpO1xuICAgIGNvbnN0IHN1cmFoID0gU1VSQUhTLmZpbmQocyA9PiBzLmlkID09PSBzdXJhaElkKTtcbiAgICBpZiAoIXN1cmFoKSByZXR1cm47XG5cbiAgICBjb25zdCBzdXJhaEtleSA9IHN1cmFoSWQudG9TdHJpbmcoKTtcbiAgICBjb25zdCBjdXJyZW50ID0gc2V0dGluZ3MubGVhcm5lZFZlcnNlc1tzdXJhaEtleV0gfHwgW107XG5cbiAgICBpZiAoY3VycmVudC5sZW5ndGggPT09IHN1cmFoLnZlcnNlQ291bnQpIHtcbiAgICAgICAgZGVsZXRlIHNldHRpbmdzLmxlYXJuZWRWZXJzZXNbc3VyYWhLZXldO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHNldHRpbmdzLmxlYXJuZWRWZXJzZXNbc3VyYWhLZXldID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogc3VyYWgudmVyc2VDb3VudCB9LCAoXywgaSkgPT4gaSArIDEpO1xuICAgIH1cblxuICAgIHNhdmVTZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgc3luY01lbW9yeU5vZGVzV2l0aExlYXJuZWQoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFN1cmFoTGVhcm5lZFN0YXR1cyhzdXJhaElkOiBudW1iZXIpOiB7IGxlYXJuZWQ6IG51bWJlcjsgdG90YWw6IG51bWJlciB9IHtcbiAgICBjb25zdCBzZXR0aW5ncyA9IGdldFNldHRpbmdzKCk7XG4gICAgY29uc3Qgc3VyYWggPSBTVVJBSFMuZmluZChzID0+IHMuaWQgPT09IHN1cmFoSWQpO1xuICAgIGlmICghc3VyYWgpIHJldHVybiB7IGxlYXJuZWQ6IDAsIHRvdGFsOiAwIH07XG5cbiAgICBjb25zdCBsZWFybmVkID0gc2V0dGluZ3MubGVhcm5lZFZlcnNlc1tzdXJhaElkXT8ubGVuZ3RoIHx8IDA7XG4gICAgcmV0dXJuIHsgbGVhcm5lZCwgdG90YWw6IHN1cmFoLnZlcnNlQ291bnQgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRvdGFsTGVhcm5lZFZlcnNlcygpOiBudW1iZXIge1xuICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0U2V0dGluZ3MoKTtcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhzZXR0aW5ncy5sZWFybmVkVmVyc2VzKS5yZWR1Y2UoKHN1bSwgdmVyc2VzKSA9PiBzdW0gKyB2ZXJzZXMubGVuZ3RoLCAwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExlYXJuZWRWZXJzZXNJblBhcnQocGFydDogUXVyYW5QYXJ0KTogeyBzdXJhaElkOiBudW1iZXI7IGF5YWhJZDogbnVtYmVyIH1bXSB7XG4gICAgY29uc3Qgc2V0dGluZ3MgPSBnZXRTZXR0aW5ncygpO1xuICAgIGNvbnN0IHJlc3VsdDogeyBzdXJhaElkOiBudW1iZXI7IGF5YWhJZDogbnVtYmVyIH1bXSA9IFtdO1xuXG4gICAgU1VSQUhTLmZpbHRlcihzID0+IHMucGFydCA9PT0gcGFydCkuZm9yRWFjaChzdXJhaCA9PiB7XG4gICAgICAgIGNvbnN0IHZlcnNlcyA9IHNldHRpbmdzLmxlYXJuZWRWZXJzZXNbc3VyYWguaWRdIHx8IFtdO1xuICAgICAgICB2ZXJzZXMuZm9yRWFjaChheWFoSWQgPT4ge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goeyBzdXJhaElkOiBzdXJhaC5pZCwgYXlhaElkIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE1lbW9yeSBOb2RlcyAoU00tMilcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBTTTJTdGF0ZSB7XG4gICAgaW50ZXJ2YWw6IG51bWJlcjtcbiAgICByZXBldGl0aW9uOiBudW1iZXI7XG4gICAgZWFzZUZhY3RvcjogbnVtYmVyO1xuICAgIGR1ZURhdGU6IHN0cmluZztcbiAgICBsYXN0UmV2aWV3OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWVtb3J5Tm9kZSB7XG4gICAgaWQ6IHN0cmluZztcbiAgICB0eXBlOiAndmVyc2UnIHwgJ21pbmRtYXAnIHwgJ3BhcnRfbWluZG1hcCc7XG4gICAgc3VyYWhJZD86IG51bWJlcjtcbiAgICBwYXJ0SWQ/OiBRdXJhblBhcnQ7XG4gICAgc3RhcnRWZXJzZT86IG51bWJlcjtcbiAgICBlbmRWZXJzZT86IG51bWJlcjtcbiAgICBzY2hlZHVsZXI6IFNNMlN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWVtb3J5Tm9kZXMoKTogTWVtb3J5Tm9kZVtdIHtcbiAgICByZXR1cm4gZ2V0RnJvbUNhY2hlKFNUT1JBR0VfS0VZUy5NRU1PUllfTk9ERVMsIFtdKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhdmVNZW1vcnlOb2Rlcyhub2RlczogTWVtb3J5Tm9kZVtdKTogdm9pZCB7XG4gICAgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuTUVNT1JZX05PREVTLCBub2Rlcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREdWVOb2RlcygpOiBNZW1vcnlOb2RlW10ge1xuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgY29uc3Qgc2V0dGluZ3MgPSBnZXRTZXR0aW5ncygpO1xuICAgIGNvbnN0IHNraXBzID0gbmV3IFNldChzZXR0aW5ncy5za2lwcGVkU3VyYWhzIHx8IFtdKTtcbiAgICBjb25zdCBzdXNwZW5kZWQgPSBnZXRTdXNwZW5kZWRBbmNob3JzKCk7XG5cbiAgICByZXR1cm4gZ2V0TWVtb3J5Tm9kZXMoKVxuICAgICAgICAuZmlsdGVyKG4gPT4gbi5zY2hlZHVsZXIuZHVlRGF0ZSA8PSB0b2RheSlcbiAgICAgICAgLmZpbHRlcihuID0+ICFuLnN1cmFoSWQgfHwgIXNraXBzLmhhcyhuLnN1cmFoSWQpKVxuICAgICAgICAuZmlsdGVyKG4gPT4gIWlzTm9kZVN1c3BlbmRlZChuLCBzdXNwZW5kZWQpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1lbW9yeU5vZGUobm9kZTogTWVtb3J5Tm9kZSk6IHZvaWQge1xuICAgIGNvbnN0IG5vZGVzID0gZ2V0TWVtb3J5Tm9kZXMoKTtcbiAgICBjb25zdCBpbmRleCA9IG5vZGVzLmZpbmRJbmRleChuID0+IG4uaWQgPT09IG5vZGUuaWQpO1xuICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgIG5vZGVzW2luZGV4XSA9IG5vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICB9XG4gICAgc2F2ZU1lbW9yeU5vZGVzKG5vZGVzKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlTmV3U2NoZWR1bGVyKCk6IFNNMlN0YXRlIHtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgIHJldHVybiB7XG4gICAgICAgIGludGVydmFsOiAwLFxuICAgICAgICByZXBldGl0aW9uOiAwLFxuICAgICAgICBlYXNlRmFjdG9yOiAyLjUsXG4gICAgICAgIGR1ZURhdGU6IHRvZGF5LFxuICAgICAgICBsYXN0UmV2aWV3OiAnJyxcbiAgICB9O1xufVxuXG4vLyBTeW5jIG1lbW9yeSBub2RlcyB3aXRoIGxlYXJuZWQgdmVyc2VzIC0gY3JlYXRlIG5vZGVzIGZvciBsZWFybmVkIHZlcnNlc1xuZXhwb3J0IGZ1bmN0aW9uIHN5bmNNZW1vcnlOb2Rlc1dpdGhMZWFybmVkKGZvcmNlRnVsbFJlc2V0OiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcbiAgICBjb25zdCBzZXR0aW5ncyA9IGdldFNldHRpbmdzKCk7XG4gICAgY29uc3Qgbm9kZXMgPSBmb3JjZUZ1bGxSZXNldCA/IFtdIDogZ2V0TWVtb3J5Tm9kZXMoKTtcblxuICAgIC8vIEdyb3VwIHZlcnNlcyBpbnRvIHNlZ21lbnRzIG9mIDVcbiAgICBPYmplY3QuZW50cmllcyhzZXR0aW5ncy5sZWFybmVkVmVyc2VzKS5mb3JFYWNoKChbc3VyYWhJZFN0ciwgdmVyc2VzXSkgPT4ge1xuICAgICAgICBjb25zdCBzdXJhaElkID0gcGFyc2VJbnQoc3VyYWhJZFN0cik7XG4gICAgICAgIGlmICh2ZXJzZXMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICAgICAgLy8gQ3JlYXRlIHNlZ21lbnRzIG9mIDUgdmVyc2VzXG4gICAgICAgIGNvbnN0IHNvcnRlZFZlcnNlcyA9IFsuLi52ZXJzZXNdLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgICAgICAgbGV0IHNlZ21lbnRTdGFydCA9IHNvcnRlZFZlcnNlc1swXTtcbiAgICAgICAgbGV0IHNlZ21lbnRFbmQgPSBzZWdtZW50U3RhcnQ7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gc29ydGVkVmVyc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBpc0NvbnRpZ3VvdXMgPSBpIDwgc29ydGVkVmVyc2VzLmxlbmd0aCAmJiBzb3J0ZWRWZXJzZXNbaV0gPT09IHNlZ21lbnRFbmQgKyAxO1xuICAgICAgICAgICAgY29uc3Qgc2VnbWVudFNpemUgPSBzZWdtZW50RW5kIC0gc2VnbWVudFN0YXJ0ICsgMTtcblxuICAgICAgICAgICAgaWYgKCFpc0NvbnRpZ3VvdXMgfHwgc2VnbWVudFNpemUgPj0gNSB8fCBpID09PSBzb3J0ZWRWZXJzZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5vZGUgZm9yIHRoaXMgc2VnbWVudCBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gYHZlcnNlLSR7c3VyYWhJZH0tJHtzZWdtZW50U3RhcnR9LSR7c2VnbWVudEVuZH1gO1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IG5vZGVzLnNvbWUobiA9PiBuLmlkID09PSBub2RlSWQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICghZXhpc3RzIHx8IGZvcmNlRnVsbFJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld05vZGU6IE1lbW9yeU5vZGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogbm9kZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3ZlcnNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1cmFoSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydFZlcnNlOiBzZWdtZW50U3RhcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRWZXJzZTogc2VnbWVudEVuZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlcjogY3JlYXRlTmV3U2NoZWR1bGVyKCksXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcmNlRnVsbFJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5ld05vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobmV3Tm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaSA8IHNvcnRlZFZlcnNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudFN0YXJ0ID0gc29ydGVkVmVyc2VzW2ldO1xuICAgICAgICAgICAgICAgICAgICBzZWdtZW50RW5kID0gc2VnbWVudFN0YXJ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VnbWVudEVuZCA9IHNvcnRlZFZlcnNlc1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKGZvcmNlRnVsbFJlc2V0KSB7XG4gICAgICAgIC8vIEFsc28gc3luYyBtaW5kbWFwc1xuICAgICAgICBjb25zdCBtaW5kbWFwcyA9IGdldE1pbmRNYXBzKCk7XG4gICAgICAgIE9iamVjdC52YWx1ZXMobWluZG1hcHMpLmZvckVhY2gobW0gPT4ge1xuICAgICAgICAgICAgaWYgKG1tLmlzQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGBtaW5kbWFwLSR7bW0uc3VyYWhJZH1gLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbWluZG1hcCcsXG4gICAgICAgICAgICAgICAgICAgIHN1cmFoSWQ6IG1tLnN1cmFoSWQsXG4gICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlcjogY3JlYXRlTmV3U2NoZWR1bGVyKCksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFsc28gc3luYyBwYXJ0IG1pbmRtYXBzXG4gICAgICAgIGNvbnN0IHBhcnRNaW5kbWFwcyA9IGdldFBhcnRNaW5kTWFwcygpO1xuICAgICAgICBPYmplY3QudmFsdWVzKHBhcnRNaW5kbWFwcykuZm9yRWFjaChwbW0gPT4ge1xuICAgICAgICAgICAgaWYgKHBtbS5pc0NvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgbm9kZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBgcGFydC1taW5kbWFwLSR7cG1tLnBhcnRJZH1gLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAncGFydF9taW5kbWFwJyxcbiAgICAgICAgICAgICAgICAgICAgcGFydElkOiBwbW0ucGFydElkLFxuICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZXI6IGNyZWF0ZU5ld1NjaGVkdWxlcigpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzYXZlTWVtb3J5Tm9kZXMobm9kZXMpO1xufVxuXG4vLyBTTS0yIEFsZ29yaXRobVxuZXhwb3J0IGZ1bmN0aW9uIHNtMihncmFkZTogbnVtYmVyLCBzdGF0ZTogU00yU3RhdGUpOiBTTTJTdGF0ZSB7XG4gICAgbGV0IHsgaW50ZXJ2YWwsIHJlcGV0aXRpb24sIGVhc2VGYWN0b3IgfSA9IHN0YXRlO1xuXG4gICAgaWYgKGdyYWRlIDwgMykge1xuICAgICAgICByZXBldGl0aW9uID0gMDtcbiAgICAgICAgaW50ZXJ2YWwgPSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChyZXBldGl0aW9uID09PSAwKSBpbnRlcnZhbCA9IDE7XG4gICAgICAgIGVsc2UgaWYgKHJlcGV0aXRpb24gPT09IDEpIGludGVydmFsID0gNjtcbiAgICAgICAgZWxzZSBpbnRlcnZhbCA9IE1hdGgucm91bmQoaW50ZXJ2YWwgKiBlYXNlRmFjdG9yKTtcbiAgICAgICAgcmVwZXRpdGlvbisrO1xuICAgIH1cblxuICAgIGVhc2VGYWN0b3IgPSBNYXRoLm1heCgxLjMsIGVhc2VGYWN0b3IgKyAoMC4xIC0gKDUgLSBncmFkZSkgKiAoMC4wOCArICg1IC0gZ3JhZGUpICogMC4wMikpKTtcblxuICAgIGNvbnN0IGR1ZURhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGR1ZURhdGUuc2V0RGF0ZShkdWVEYXRlLmdldERhdGUoKSArIGludGVydmFsKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGludGVydmFsLFxuICAgICAgICByZXBldGl0aW9uLFxuICAgICAgICBlYXNlRmFjdG9yOiBNYXRoLnJvdW5kKGVhc2VGYWN0b3IgKiAxMDApIC8gMTAwLFxuICAgICAgICBkdWVEYXRlOiBkdWVEYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcbiAgICAgICAgbGFzdFJldmlldzogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sXG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvc3Rwb25lTm9kZShub2RlOiBNZW1vcnlOb2RlKTogTWVtb3J5Tm9kZSB7XG4gICAgY29uc3QgdG9tb3Jyb3cgPSBuZXcgRGF0ZSgpO1xuICAgIHRvbW9ycm93LnNldERhdGUodG9tb3Jyb3cuZ2V0RGF0ZSgpICsgMSk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgLi4ubm9kZSxcbiAgICAgICAgc2NoZWR1bGVyOiB7XG4gICAgICAgICAgICAuLi5ub2RlLnNjaGVkdWxlcixcbiAgICAgICAgICAgIGR1ZURhdGU6IHRvbW9ycm93LnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcbiAgICAgICAgICAgIGxhc3RSZXZpZXc6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLFxuICAgICAgICB9XG4gICAgfTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gTWluZG1hcHMgKHBlciBzdXJhaClcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBBbmNob3Ige1xuICAgIGlkOiBzdHJpbmc7XG4gICAgc3RhcnRWZXJzZTogbnVtYmVyO1xuICAgIGVuZFZlcnNlOiBudW1iZXI7XG4gICAgbGFiZWw6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNaW5kTWFwIHtcbiAgICBzdXJhaElkOiBudW1iZXI7XG4gICAgaW1hZ2VVcmw6IHN0cmluZyB8IG51bGw7XG4gICAgYW5jaG9yczogQW5jaG9yW107XG4gICAgaXNDb21wbGV0ZTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1pbmRNYXBzKCk6IHsgW3N1cmFoSWQ6IHN0cmluZ106IE1pbmRNYXAgfSB7XG4gICAgcmV0dXJuIGdldEZyb21DYWNoZShTVE9SQUdFX0tFWVMuTUlORE1BUFMsIHt9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1pbmRNYXAoc3VyYWhJZDogbnVtYmVyKTogTWluZE1hcCB7XG4gICAgY29uc3QgbWFwcyA9IGdldE1pbmRNYXBzKCk7XG4gICAgcmV0dXJuIG1hcHNbc3VyYWhJZF0gfHwgeyBzdXJhaElkLCBpbWFnZVVybDogbnVsbCwgYW5jaG9yczogW10sIGlzQ29tcGxldGU6IGZhbHNlIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYXZlTWluZE1hcChtaW5kbWFwOiBNaW5kTWFwKTogdm9pZCB7XG4gICAgY29uc3QgbWFwcyA9IGdldE1pbmRNYXBzKCk7XG4gICAgbWFwc1ttaW5kbWFwLnN1cmFoSWRdID0gbWluZG1hcDtcbiAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5NSU5ETUFQUywgbWFwcyk7XG5cbiAgICAvLyBDcmVhdGUvdXBkYXRlIG1lbW9yeSBub2RlIGZvciBtaW5kbWFwIGlmIGNvbXBsZXRlXG4gICAgaWYgKG1pbmRtYXAuaXNDb21wbGV0ZSkge1xuICAgICAgICBjb25zdCBub2RlcyA9IGdldE1lbW9yeU5vZGVzKCk7XG4gICAgICAgIGNvbnN0IG5vZGVJZCA9IGBtaW5kbWFwLSR7bWluZG1hcC5zdXJhaElkfWA7XG4gICAgICAgIGNvbnN0IGV4aXN0cyA9IG5vZGVzLnNvbWUobiA9PiBuLmlkID09PSBub2RlSWQpO1xuICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgICAgbm9kZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IG5vZGVJZCxcbiAgICAgICAgICAgICAgICB0eXBlOiAnbWluZG1hcCcsXG4gICAgICAgICAgICAgICAgc3VyYWhJZDogbWluZG1hcC5zdXJhaElkLFxuICAgICAgICAgICAgICAgIHNjaGVkdWxlcjogY3JlYXRlTmV3U2NoZWR1bGVyKCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNhdmVNZW1vcnlOb2Rlcyhub2Rlcyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBhcnQgTWluZG1hcHMgKGludGVyLXN1cmFoIGNvbm5lY3Rpb25zKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhcnRNaW5kTWFwIHtcbiAgICBwYXJ0SWQ6IFF1cmFuUGFydDtcbiAgICBpbWFnZVVybDogc3RyaW5nIHwgbnVsbDtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGlzQ29tcGxldGU6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXJ0TWluZE1hcHMoKTogeyBbcGFydElkOiBzdHJpbmddOiBQYXJ0TWluZE1hcCB9IHtcbiAgICByZXR1cm4gZ2V0RnJvbUNhY2hlKFNUT1JBR0VfS0VZUy5QQVJUX01JTkRNQVBTLCB7fSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXJ0TWluZE1hcChwYXJ0SWQ6IFF1cmFuUGFydCk6IFBhcnRNaW5kTWFwIHtcbiAgICBjb25zdCBtYXBzID0gZ2V0UGFydE1pbmRNYXBzKCk7XG4gICAgcmV0dXJuIG1hcHNbcGFydElkXSB8fCB7IHBhcnRJZCwgaW1hZ2VVcmw6IG51bGwsIGRlc2NyaXB0aW9uOiAnJywgaXNDb21wbGV0ZTogZmFsc2UgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhdmVQYXJ0TWluZE1hcChtaW5kbWFwOiBQYXJ0TWluZE1hcCk6IHZvaWQge1xuICAgIGNvbnN0IG1hcHMgPSBnZXRQYXJ0TWluZE1hcHMoKTtcbiAgICBtYXBzW21pbmRtYXAucGFydElkXSA9IG1pbmRtYXA7XG4gICAgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuUEFSVF9NSU5ETUFQUywgbWFwcyk7XG5cbiAgICAvLyBDcmVhdGUgbWVtb3J5IG5vZGUgZm9yIHBhcnQgbWluZG1hcCBpZiBjb21wbGV0ZVxuICAgIGlmIChtaW5kbWFwLmlzQ29tcGxldGUpIHtcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBnZXRNZW1vcnlOb2RlcygpO1xuICAgICAgICBjb25zdCBub2RlSWQgPSBgcGFydC1taW5kbWFwLSR7bWluZG1hcC5wYXJ0SWR9YDtcbiAgICAgICAgY29uc3QgZXhpc3RzID0gbm9kZXMuc29tZShuID0+IG4uaWQgPT09IG5vZGVJZCk7XG4gICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICBub2Rlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogbm9kZUlkLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdwYXJ0X21pbmRtYXAnLFxuICAgICAgICAgICAgICAgIHBhcnRJZDogbWluZG1hcC5wYXJ0SWQsXG4gICAgICAgICAgICAgICAgc2NoZWR1bGVyOiBjcmVhdGVOZXdTY2hlZHVsZXIoKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2F2ZU1lbW9yeU5vZGVzKG5vZGVzKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gTGlzdGVuaW5nIFN0YXRzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGlzdGVuaW5nU3RhdHMge1xuICAgIHN1cmFoSWQ6IG51bWJlcjtcbiAgICB0b3RhbE1pbnV0ZXM6IG51bWJlcjtcbiAgICBsYXN0TGlzdGVuZWQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMaXN0ZW5pbmdQcm9ncmVzcyB7XG4gICAgcGFydElkOiBRdXJhblBhcnQ7XG4gICAgY3VycmVudFZlcnNlSW5kZXg6IG51bWJlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RlbmluZ1Byb2dyZXNzKHBhcnRJZDogUXVyYW5QYXJ0KTogTGlzdGVuaW5nUHJvZ3Jlc3Mge1xuICAgIGNvbnN0IG1hcCA9IGdldEZyb21DYWNoZTxSZWNvcmQ8c3RyaW5nLCBMaXN0ZW5pbmdQcm9ncmVzcz4+KFNUT1JBR0VfS0VZUy5MSVNURU5JTkdfUFJPR1JFU1MsIHt9KTtcbiAgICByZXR1cm4gbWFwW3BhcnRJZF0gfHwgeyBwYXJ0SWQsIGN1cnJlbnRWZXJzZUluZGV4OiAwIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYXZlTGlzdGVuaW5nUHJvZ3Jlc3MocGFydElkOiBRdXJhblBhcnQsIGN1cnJlbnRWZXJzZUluZGV4OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBtYXAgPSBnZXRGcm9tQ2FjaGU8UmVjb3JkPHN0cmluZywgTGlzdGVuaW5nUHJvZ3Jlc3M+PihTVE9SQUdFX0tFWVMuTElTVEVOSU5HX1BST0dSRVNTLCB7fSk7XG4gICAgbWFwW3BhcnRJZF0gPSB7IHBhcnRJZCwgY3VycmVudFZlcnNlSW5kZXggfTtcbiAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5MSVNURU5JTkdfUFJPR1JFU1MsIG1hcCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMaXN0ZW5pbmdTdGF0cygpOiB7IFtzdXJhaElkOiBzdHJpbmddOiBMaXN0ZW5pbmdTdGF0cyB9IHtcbiAgICByZXR1cm4gZ2V0RnJvbUNhY2hlKFNUT1JBR0VfS0VZUy5MSVNURU5JTkdfU1RBVFMsIHt9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RlbmluZ1N0YXRzRm9yU3VyYWgoc3VyYWhJZDogbnVtYmVyKTogTGlzdGVuaW5nU3RhdHMge1xuICAgIGNvbnN0IHN0YXRzID0gZ2V0TGlzdGVuaW5nU3RhdHMoKTtcbiAgICByZXR1cm4gc3RhdHNbc3VyYWhJZF0gfHwgeyBzdXJhaElkLCB0b3RhbE1pbnV0ZXM6IDAsIGxhc3RMaXN0ZW5lZDogJycgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZExpc3RlbmluZ1RpbWUoc3VyYWhJZDogbnVtYmVyLCBtaW51dGVzOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBzdGF0cyA9IGdldExpc3RlbmluZ1N0YXRzKCk7XG4gICAgY29uc3QgY3VycmVudCA9IHN0YXRzW3N1cmFoSWRdIHx8IHsgc3VyYWhJZCwgdG90YWxNaW51dGVzOiAwLCBsYXN0TGlzdGVuZWQ6ICcnIH07XG4gICAgY3VycmVudC50b3RhbE1pbnV0ZXMgKz0gbWludXRlcztcbiAgICBjdXJyZW50Lmxhc3RMaXN0ZW5lZCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBzdGF0c1tzdXJhaElkXSA9IGN1cnJlbnQ7XG4gICAgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuTElTVEVOSU5HX1NUQVRTLCBzdGF0cyk7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIExpc3RlbmluZyBDb21wbGV0ZSBUcmFja2luZ1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGlzdGVuaW5nQ29tcGxldGVkVG9kYXkoKTogYm9vbGVhbiB7XG4gICAgY29uc3Qgc3RvcmVkID0gZ2V0RnJvbUNhY2hlPHN0cmluZyB8IG51bGw+KFNUT1JBR0VfS0VZUy5MSVNURU5JTkdfQ09NUExFVEUsIG51bGwpO1xuICAgIGlmICghc3RvcmVkKSByZXR1cm4gZmFsc2U7XG4gICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgICByZXR1cm4gc3RvcmVkID09PSB0b2RheTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hcmtMaXN0ZW5pbmdDb21wbGV0ZSgpOiB2b2lkIHtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgIHNhdmVUb0NhY2hlQW5kU3RvcmUoU1RPUkFHRV9LRVlTLkxJU1RFTklOR19DT01QTEVURSwgdG9kYXkpO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBSZXZpZXcgRXJyb3JzIFRyYWNraW5nXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmV2aWV3RXJyb3Ige1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdGltZXN0YW1wOiBzdHJpbmc7XG4gICAgbm9kZUlkOiBzdHJpbmc7XG4gICAgbm9kZVR5cGU6ICd2ZXJzZScgfCAnbWluZG1hcCcgfCAncGFydF9taW5kbWFwJztcbiAgICBzdXJhaElkPzogbnVtYmVyO1xuICAgIHBhcnRJZD86IFF1cmFuUGFydDtcbiAgICBzdGFydFZlcnNlPzogbnVtYmVyO1xuICAgIGVuZFZlcnNlPzogbnVtYmVyO1xuICAgIGdyYWRlOiBudW1iZXI7XG4gICAgYW5jaG9yTGFiZWw/OiBzdHJpbmc7XG4gICAgYW5jaG9ySWQ/OiBzdHJpbmc7XG4gICAgYWJzb2x1dGVBeWFoPzogbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmV2aWV3RXJyb3JzKCk6IFJldmlld0Vycm9yW10ge1xuICAgIHJldHVybiBnZXRGcm9tQ2FjaGUoU1RPUkFHRV9LRVlTLlJFVklFV19FUlJPUlMsIFtdKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhdmVSZXZpZXdFcnJvcihlcnJvcjogUmV2aWV3RXJyb3IpOiB2b2lkIHtcbiAgICBjb25zdCBlcnJvcnMgPSBnZXRSZXZpZXdFcnJvcnMoKTtcbiAgICBlcnJvcnMucHVzaChlcnJvcik7XG4gICAgLy8gS2VlcCBvbmx5IGxhc3QgMTAwIGVycm9yc1xuICAgIGNvbnN0IHRyaW1tZWQgPSBlcnJvcnMuc2xpY2UoLTEwMCk7XG4gICAgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuUkVWSUVXX0VSUk9SUywgdHJpbW1lZCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVSZXZpZXdFcnJvcihpZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgZXJyb3JzID0gZ2V0UmV2aWV3RXJyb3JzKCk7XG4gICAgY29uc3QgcmVtYWluaW5nID0gZXJyb3JzLmZpbHRlcihlID0+IGUuaWQgIT09IGlkKTtcbiAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5SRVZJRVdfRVJST1JTLCByZW1haW5pbmcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXJyb3JzQnlBbmNob3IoKTogeyBsYWJlbDogc3RyaW5nOyBjb3VudDogbnVtYmVyOyBzdXJhaElkPzogbnVtYmVyOyBhbmNob3JJZD86IHN0cmluZzsgc3RhcnRWZXJzZT86IG51bWJlcjsgZW5kVmVyc2U/OiBudW1iZXIgfVtdIHtcbiAgICBjb25zdCBlcnJvcnMgPSBnZXRSZXZpZXdFcnJvcnMoKTtcbiAgICBjb25zdCBtaW5kbWFwcyA9IGdldE1pbmRNYXBzKCk7XG4gICAgY29uc3QgYW5jaG9yQ291bnRzOiB7IFtrZXk6IHN0cmluZ106IHsgbGFiZWw6IHN0cmluZzsgY291bnQ6IG51bWJlcjsgc3VyYWhJZD86IG51bWJlcjsgYW5jaG9ySWQ/OiBzdHJpbmc7IHN0YXJ0VmVyc2U/OiBudW1iZXI7IGVuZFZlcnNlPzogbnVtYmVyIH0gfSA9IHt9O1xuXG4gICAgZXJyb3JzLmZpbHRlcihlID0+IGUuZ3JhZGUgPCAzKS5mb3JFYWNoKGVycm9yID0+IHtcbiAgICAgICAgaWYgKGVycm9yLnN1cmFoSWQgJiYgZXJyb3Iuc3RhcnRWZXJzZSAmJiBlcnJvci5lbmRWZXJzZSkge1xuICAgICAgICAgICAgY29uc3QgbWluZG1hcCA9IG1pbmRtYXBzW2Vycm9yLnN1cmFoSWRdO1xuICAgICAgICAgICAgaWYgKG1pbmRtYXApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhbmNob3IgPSBtaW5kbWFwLmFuY2hvcnMuZmluZChhID0+XG4gICAgICAgICAgICAgICAgICAgIGEuc3RhcnRWZXJzZSA8PSBlcnJvci5zdGFydFZlcnNlISAmJiBhLmVuZFZlcnNlID49IGVycm9yLmVuZFZlcnNlIVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaWYgKGFuY2hvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBgJHtlcnJvci5zdXJhaElkfS0ke2FuY2hvci5pZH1gO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFuY2hvckNvdW50c1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNob3JDb3VudHNba2V5XSA9IHsgbGFiZWw6IGFuY2hvci5sYWJlbCwgY291bnQ6IDAsIHN1cmFoSWQ6IGVycm9yLnN1cmFoSWQsIGFuY2hvcklkOiBhbmNob3IuaWQsIHN0YXJ0VmVyc2U6IGFuY2hvci5zdGFydFZlcnNlLCBlbmRWZXJzZTogYW5jaG9yLmVuZFZlcnNlIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYW5jaG9yQ291bnRzW2tleV0uY291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBPYmplY3QudmFsdWVzKGFuY2hvckNvdW50cykuc29ydCgoYSwgYikgPT4gYi5jb3VudCAtIGEuY291bnQpO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDeWNsZSBNYW5hZ2VtZW50XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDeWNsZVN0YXJ0KCk6IHN0cmluZyB7XG4gICAgbGV0IHN0b3JlZCA9IGdldEZyb21DYWNoZTxzdHJpbmcgfCBudWxsPihTVE9SQUdFX0tFWVMuQ1lDTEVfU1RBUlQsIG51bGwpO1xuICAgIGlmICghc3RvcmVkKSB7XG4gICAgICAgIHN0b3JlZCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgICAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5DWUNMRV9TVEFSVCwgc3RvcmVkKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0b3JlZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldEN5Y2xlU3RhcnQoZGF0ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuQ1lDTEVfU1RBUlQsIGRhdGUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudERheUluQ3ljbGUoKTogbnVtYmVyIHtcbiAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKGdldEN5Y2xlU3RhcnQoKSk7XG4gICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRpZmYgPSBNYXRoLmZsb29yKCh0b2RheS5nZXRUaW1lKCkgLSBzdGFydC5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcbiAgICBjb25zdCBzZXR0aW5ncyA9IGdldFNldHRpbmdzKCk7XG4gICAgcmV0dXJuIGRpZmYgJSBzZXR0aW5ncy5jb21wbGV0aW9uRGF5cztcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQmFja3VwICYgUmVzdG9yZVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLyBNYXR1cml0eSBMZXZlbHNcbmV4cG9ydCB0eXBlIE1hdHVyaXR5TGV2ZWwgPSAncmVzZXQnIHwgJ21lZGl1bScgfCAnc3Ryb25nJyB8ICdtYXN0ZXJlZCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRTdXJhaE1hdHVyaXR5KHN1cmFoSWQ6IG51bWJlciwgbGV2ZWw6IE1hdHVyaXR5TGV2ZWwpOiB2b2lkIHtcbiAgICBjb25zdCBub2RlcyA9IGdldE1lbW9yeU5vZGVzKCk7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcblxuICAgIGNvbnN0IHVwZGF0ZWROb2RlcyA9IG5vZGVzLm1hcChub2RlID0+IHtcbiAgICAgICAgaWYgKG5vZGUuc3VyYWhJZCAhPT0gc3VyYWhJZCB8fCAobm9kZS50eXBlICE9PSAndmVyc2UnICYmIG5vZGUudHlwZSAhPT0gJ21pbmRtYXAnKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaW50ZXJ2YWwgPSAxO1xuICAgICAgICBsZXQgZWZhY3RvciA9IDIuNTtcblxuICAgICAgICBzd2l0Y2ggKGxldmVsKSB7XG4gICAgICAgICAgICBjYXNlICdyZXNldCc6XG4gICAgICAgICAgICAgICAgaW50ZXJ2YWwgPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbWVkaXVtJzpcbiAgICAgICAgICAgICAgICBpbnRlcnZhbCA9IDE0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnc3Ryb25nJzpcbiAgICAgICAgICAgICAgICBpbnRlcnZhbCA9IDMwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbWFzdGVyZWQnOlxuICAgICAgICAgICAgICAgIGludGVydmFsID0gOTA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgaml0dGVyOiArLy0gMjAlXG4gICAgICAgIGlmIChsZXZlbCAhPT0gJ3Jlc2V0Jykge1xuICAgICAgICAgICAgY29uc3Qgaml0dGVyID0gaW50ZXJ2YWwgKiAwLjI7XG4gICAgICAgICAgICBpbnRlcnZhbCA9IE1hdGgucm91bmQoaW50ZXJ2YWwgKyAoTWF0aC5yYW5kb20oKSAqIGppdHRlciAqIDIgLSBqaXR0ZXIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGR1ZURhdGUgPSBuZXcgRGF0ZShub3cpO1xuICAgICAgICBkdWVEYXRlLnNldERhdGUoZHVlRGF0ZS5nZXREYXRlKCkgKyBpbnRlcnZhbCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLm5vZGUsXG4gICAgICAgICAgICBzY2hlZHVsZXI6IHtcbiAgICAgICAgICAgICAgICAuLi5ub2RlLnNjaGVkdWxlcixcbiAgICAgICAgICAgICAgICBpbnRlcnZhbCxcbiAgICAgICAgICAgICAgICBlYXNlRmFjdG9yOiBlZmFjdG9yLCAvLyBDb3JyZWN0ZWQgcHJvcGVydHkgbmFtZSBmcm9tICdlZmFjdG9yJyB0byAnZWFzZUZhY3RvcidcbiAgICAgICAgICAgICAgICBkdWVEYXRlOiBkdWVEYXRlLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICBzYXZlTWVtb3J5Tm9kZXModXBkYXRlZE5vZGVzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0QWxsTWF0dXJpdHkoKTogdm9pZCB7XG4gICAgLy8gMS4gQ2xlYXIgYWxsIG1lbW9yeSBub2Rlc1xuICAgIHNhdmVUb0NhY2hlQW5kU3RvcmUoU1RPUkFHRV9LRVlTLk1FTU9SWV9OT0RFUywgW10pO1xuICAgIFxuICAgIC8vIDIuIENsZWFyIGFsbCByZXZpZXcgZXJyb3JzXG4gICAgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuUkVWSUVXX0VSUk9SUywgW10pO1xuXG4gICAgLy8gMy4gUmVnZW5lcmF0ZSBub2RlcyBiYXNlZCBvbiBjdXJyZW50bHkgbGVhcm5lZCBzdXJhaHMgYW5kIGNvbXBsZXRlZCBtaW5kbWFwc1xuICAgIHN5bmNNZW1vcnlOb2Rlc1dpdGhMZWFybmVkKHRydWUpO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFuY2hvcklzc3VlIHtcbiAgICBhbmNob3JJZDogc3RyaW5nO1xuICAgIGxhYmVsOiBzdHJpbmc7XG4gICAgc3VyYWhJZDogbnVtYmVyO1xuICAgIGNvdW50OiBudW1iZXI7XG4gICAgc3RhcnRWZXJzZT86IG51bWJlcjtcbiAgICBlbmRWZXJzZT86IG51bWJlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFN1c3BlbmRlZEFuY2hvcnModGhyZXNob2xkOiBudW1iZXIgPSAzKTogQW5jaG9ySXNzdWVbXSB7XG4gICAgcmV0dXJuIGdldEVycm9yc0J5QW5jaG9yKClcbiAgICAgICAgLmZpbHRlcihlID0+IGUuY291bnQgPj0gdGhyZXNob2xkICYmIGUuc3VyYWhJZCAmJiBlLmFuY2hvcklkKVxuICAgICAgICAubWFwKGUgPT4gKHtcbiAgICAgICAgICAgIGFuY2hvcklkOiBlLmFuY2hvcklkISxcbiAgICAgICAgICAgIGxhYmVsOiBlLmxhYmVsLFxuICAgICAgICAgICAgc3VyYWhJZDogZS5zdXJhaElkISxcbiAgICAgICAgICAgIGNvdW50OiBlLmNvdW50LFxuICAgICAgICAgICAgc3RhcnRWZXJzZTogZS5zdGFydFZlcnNlLFxuICAgICAgICAgICAgZW5kVmVyc2U6IGUuZW5kVmVyc2UsXG4gICAgICAgIH0pKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyQW5jaG9ySXNzdWVzKHN1cmFoSWQ6IG51bWJlciwgYW5jaG9ySWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IHJlbWFpbmluZyA9IGdldFJldmlld0Vycm9ycygpLmZpbHRlcihlcnIgPT4gIShlcnIuc3VyYWhJZCA9PT0gc3VyYWhJZCAmJiBlcnIuYW5jaG9ySWQgPT09IGFuY2hvcklkKSk7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSByZXR1cm47XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oU1RPUkFHRV9LRVlTLlJFVklFV19FUlJPUlMsIEpTT04uc3RyaW5naWZ5KHJlbWFpbmluZykpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmluZEFuY2hvckZvclJhbmdlKHN1cmFoSWQ6IG51bWJlciwgc3RhcnRWZXJzZT86IG51bWJlciwgZW5kVmVyc2U/OiBudW1iZXIpOiBBbmNob3IgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IG1pbmRtYXAgPSBnZXRNaW5kTWFwKHN1cmFoSWQpO1xuICAgIGlmICghc3RhcnRWZXJzZSB8fCAhZW5kVmVyc2UpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIG1pbmRtYXAuYW5jaG9ycy5maW5kKGEgPT4gYS5zdGFydFZlcnNlIDw9IHN0YXJ0VmVyc2UgJiYgYS5lbmRWZXJzZSA+PSBlbmRWZXJzZSk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTXV0YXNoYWJpaGF0RGVjaXNpb24ge1xuICAgIHN0YXR1czogJ3BlbmRpbmcnIHwgJ2lnbm9yZWQnIHwgJ3NvbHZlZF9taW5kbWFwJyB8ICdzb2x2ZWRfbm90ZSc7XG4gICAgbm90ZT86IHN0cmluZztcbiAgICBjb25maXJtZWRBdD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21NdXRhc2hhYmloIHtcbiAgICBpZDogc3RyaW5nO1xuICAgIHZlcnNlMTogeyBzdXJhaElkOiBudW1iZXI7IGF5YWhJZDogbnVtYmVyIH07XG4gICAgdmVyc2UyOiB7IHN1cmFoSWQ6IG51bWJlcjsgYXlhaElkOiBudW1iZXIgfTtcbiAgICBzdGF0dXM6ICdwZW5kaW5nJyB8ICdpZ25vcmVkJyB8ICdzb2x2ZWRfbWluZG1hcCcgfCAnc29sdmVkX25vdGUnO1xuICAgIG5vdGU/OiBzdHJpbmc7XG4gICAgY3JlYXRlZEF0OiBzdHJpbmc7XG4gICAgaXNDdXN0b206IHRydWU7IC8vIERpc3RpbmN0aW9uIGZvciBkZXZlbG9wbWVudCBwdXJwb3Nlc1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VzdG9tTXV0YXNoYWJpaGF0KCk6IEN1c3RvbU11dGFzaGFiaWhbXSB7XG4gICAgcmV0dXJuIGdldEZyb21DYWNoZShTVE9SQUdFX0tFWVMuQ1VTVE9NX01VVEFTSEFCSUhBVCwgW10pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2F2ZUN1c3RvbU11dGFzaGFiaWgobXV0OiBDdXN0b21NdXRhc2hhYmloKTogdm9pZCB7XG4gICAgY29uc3QgYWxsID0gZ2V0Q3VzdG9tTXV0YXNoYWJpaGF0KCk7XG4gICAgY29uc3QgZXhpc3RpbmdJZHggPSBhbGwuZmluZEluZGV4KG0gPT4gbS5pZCA9PT0gbXV0LmlkKTtcbiAgICBpZiAoZXhpc3RpbmdJZHggPj0gMCkge1xuICAgICAgICBhbGxbZXhpc3RpbmdJZHhdID0gbXV0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGFsbC5wdXNoKG11dCk7XG4gICAgfVxuICAgIHNhdmVUb0NhY2hlQW5kU3RvcmUoU1RPUkFHRV9LRVlTLkNVU1RPTV9NVVRBU0hBQklIQVQsIGFsbCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVDdXN0b21NdXRhc2hhYmloKGlkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBhbGwgPSBnZXRDdXN0b21NdXRhc2hhYmloYXQoKS5maWx0ZXIobSA9PiBtLmlkICE9PSBpZCk7XG4gICAgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuQ1VTVE9NX01VVEFTSEFCSUhBVCwgYWxsKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE11dGFzaGFiaWhhdERlY2lzaW9ucygpOiBSZWNvcmQ8c3RyaW5nLCBNdXRhc2hhYmloYXREZWNpc2lvbj4ge1xuICAgIHJldHVybiBnZXRGcm9tQ2FjaGUoU1RPUkFHRV9LRVlTLk1VVEFTSEFCSUhBVF9ERUNJU0lPTlMsIHt9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldE11dGFzaGFiaWhhdERlY2lzaW9uKGFic29sdXRlQXlhaDogbnVtYmVyLCBkZWNpc2lvbjogTXV0YXNoYWJpaGF0RGVjaXNpb24sIHBocmFzZUlkPzogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgZGVjaXNpb25zID0gZ2V0TXV0YXNoYWJpaGF0RGVjaXNpb25zKCk7XG4gICAgY29uc3Qga2V5ID0gcGhyYXNlSWQgPyBgJHthYnNvbHV0ZUF5YWh9LSR7cGhyYXNlSWR9YCA6IGFic29sdXRlQXlhaC50b1N0cmluZygpO1xuICAgIGRlY2lzaW9uc1trZXldID0gZGVjaXNpb247XG4gICAgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuTVVUQVNIQUJJSEFUX0RFQ0lTSU9OUywgZGVjaXNpb25zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0TXV0YXNoYWJpaGF0RGVjaXNpb25zKGFic29sdXRlQXlhdDogbnVtYmVyW10pOiB2b2lkIHtcbiAgICBjb25zdCBkZWNpc2lvbnMgPSBnZXRNdXRhc2hhYmloYXREZWNpc2lvbnMoKTtcbiAgICBjb25zdCBrZXlzVG9EZWxldGUgPSBPYmplY3Qua2V5cyhkZWNpc2lvbnMpLmZpbHRlcihrZXkgPT4ge1xuICAgICAgICBjb25zdCBhYnMgPSBwYXJzZUludChrZXkuc3BsaXQoJy0nKVswXSwgMTApO1xuICAgICAgICByZXR1cm4gYWJzb2x1dGVBeWF0LmluY2x1ZGVzKGFicyk7XG4gICAgfSk7XG4gICAgXG4gICAgaWYgKGtleXNUb0RlbGV0ZS5sZW5ndGggPT09IDApIHJldHVybjtcbiAgICBcbiAgICBrZXlzVG9EZWxldGUuZm9yRWFjaChrZXkgPT4gZGVsZXRlIGRlY2lzaW9uc1trZXldKTtcbiAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5NVVRBU0hBQklIQVRfREVDSVNJT05TLCBkZWNpc2lvbnMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYnVsa1NldFN1cmFoU3RhdHVzKHN1cmFoSWRzOiBudW1iZXJbXSwgc3RhdHVzOiAnbGVhcm5lZCcgfCAnbmV3JyB8ICdza2lwcGVkJyk6IHZvaWQge1xuICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0U2V0dGluZ3MoKTtcbiAgICBjb25zdCBhbGxTdXJhaHMgPSBTVVJBSFM7XG5cbiAgICBzdXJhaElkcy5mb3JFYWNoKGlkID0+IHtcbiAgICAgICAgY29uc3Qgc3VyYWggPSBhbGxTdXJhaHMuZmluZChzID0+IHMuaWQgPT09IGlkKTtcbiAgICAgICAgaWYgKCFzdXJhaCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IHN1cmFoS2V5ID0gaWQudG9TdHJpbmcoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlc2V0IHN0YXRlIGZvciB0aGlzIHN1cmFoIGZpcnN0XG4gICAgICAgIGRlbGV0ZSBzZXR0aW5ncy5sZWFybmVkVmVyc2VzW3N1cmFoS2V5XTtcbiAgICAgICAgc2V0dGluZ3Muc2tpcHBlZFN1cmFocyA9IChzZXR0aW5ncy5za2lwcGVkU3VyYWhzIHx8IFtdKS5maWx0ZXIoc0lkID0+IHNJZCAhPT0gaWQpO1xuXG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdsZWFybmVkJykge1xuICAgICAgICAgICAgY29uc3QgdmVyc2VJZHMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBzdXJhaC52ZXJzZUNvdW50IH0sIChfLCBpKSA9PiBpICsgMSk7XG4gICAgICAgICAgICBzZXR0aW5ncy5sZWFybmVkVmVyc2VzW3N1cmFoS2V5XSA9IHZlcnNlSWRzO1xuICAgICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gJ3NraXBwZWQnKSB7XG4gICAgICAgICAgICBzZXR0aW5ncy5za2lwcGVkU3VyYWhzID0gWy4uLihzZXR0aW5ncy5za2lwcGVkU3VyYWhzIHx8IFtdKSwgaWRdO1xuICAgICAgICAgICAgcHJ1bmVTdXJhaEFydGlmYWN0cyhpZCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gJ25ldycgc3RhdHVzIGlzIGFscmVhZHkgaGFuZGxlZCBieSB0aGUgcmVzZXRzIGFib3ZlXG4gICAgfSk7XG5cbiAgICBpZiAoc2V0dGluZ3Muc2tpcHBlZFN1cmFocykge1xuICAgICAgICBzZXR0aW5ncy5za2lwcGVkU3VyYWhzLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgICB9XG4gICAgc2F2ZVNldHRpbmdzKHNldHRpbmdzKTtcbn1cblxuZnVuY3Rpb24gcHJ1bmVTdXJhaEFydGlmYWN0cyhzdXJhaElkOiBudW1iZXIpOiB2b2lkIHtcbiAgICAvLyBSZW1vdmUgbWVtb3J5IG5vZGVzIGZvciB0aGlzIHN1cmFoXG4gICAgY29uc3Qgbm9kZXMgPSBnZXRNZW1vcnlOb2RlcygpLmZpbHRlcihuID0+IG4uc3VyYWhJZCAhPT0gc3VyYWhJZCk7XG4gICAgc2F2ZU1lbW9yeU5vZGVzKG5vZGVzKTtcblxuICAgIC8vIFJlbW92ZSBzdXJhaCBtaW5kbWFwXG4gICAgY29uc3QgbWFwcyA9IGdldE1pbmRNYXBzKCk7XG4gICAgaWYgKG1hcHNbc3VyYWhJZF0pIHtcbiAgICAgICAgZGVsZXRlIG1hcHNbc3VyYWhJZF07XG4gICAgICAgIHNhdmVUb0NhY2hlQW5kU3RvcmUoU1RPUkFHRV9LRVlTLk1JTkRNQVBTLCBtYXBzKTtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgcmV2aWV3IGVycm9yc1xuICAgIGNvbnN0IHJlbWFpbmluZ0Vycm9ycyA9IGdldFJldmlld0Vycm9ycygpLmZpbHRlcihlcnIgPT4gZXJyLnN1cmFoSWQgIT09IHN1cmFoSWQpO1xuICAgIHNhdmVUb0NhY2hlQW5kU3RvcmUoU1RPUkFHRV9LRVlTLlJFVklFV19FUlJPUlMsIHJlbWFpbmluZ0Vycm9ycyk7XG59XG5cbmZ1bmN0aW9uIGlzTm9kZVN1c3BlbmRlZChub2RlOiBNZW1vcnlOb2RlLCBpc3N1ZXM6IEFuY2hvcklzc3VlW10pOiBib29sZWFuIHtcbiAgICBpZiAoIW5vZGUuc3VyYWhJZCkgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHJlbGF0ZWRJc3N1ZXMgPSBpc3N1ZXMuZmlsdGVyKGkgPT4gaS5zdXJhaElkID09PSBub2RlLnN1cmFoSWQpO1xuICAgIGlmIChyZWxhdGVkSXNzdWVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgaWYgKG5vZGUudHlwZSA9PT0gJ21pbmRtYXAnKSByZXR1cm4gdHJ1ZTtcbiAgICBpZiAobm9kZS50eXBlID09PSAndmVyc2UnKSB7XG4gICAgICAgIGNvbnN0IGFuY2hvciA9IGZpbmRBbmNob3JGb3JSYW5nZShub2RlLnN1cmFoSWQsIG5vZGUuc3RhcnRWZXJzZSwgbm9kZS5lbmRWZXJzZSk7XG4gICAgICAgIHJldHVybiBhbmNob3IgPyByZWxhdGVkSXNzdWVzLnNvbWUoaSA9PiBpLmFuY2hvcklkID09PSBhbmNob3IuaWQpIDogZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCYWNrdXBEYXRhIHtcbiAgICBzZXR0aW5ncz86IEFwcFNldHRpbmdzO1xuICAgIG1lbW9yeU5vZGVzPzogTWVtb3J5Tm9kZVtdO1xuICAgIG1pbmRtYXBzPzogeyBbc3VyYWhJZDogc3RyaW5nXTogTWluZE1hcCB9O1xuICAgIHBhcnRNaW5kbWFwcz86IHsgW3BhcnRJZDogc3RyaW5nXTogUGFydE1pbmRNYXAgfTtcbiAgICBsaXN0ZW5pbmdTdGF0cz86IHsgW3N1cmFoSWQ6IHN0cmluZ106IExpc3RlbmluZ1N0YXRzIH07XG4gICAgbGlzdGVuaW5nUHJvZ3Jlc3M/OiBSZWNvcmQ8c3RyaW5nLCBMaXN0ZW5pbmdQcm9ncmVzcz47XG4gICAgcmV2aWV3RXJyb3JzPzogUmV2aWV3RXJyb3JbXTtcbiAgICBtdXRhc2hhYmloYXREZWNpc2lvbnM/OiBSZWNvcmQ8c3RyaW5nLCBNdXRhc2hhYmloYXREZWNpc2lvbj47XG4gICAgY3VzdG9tTXV0YXNoYWJpaGF0PzogQ3VzdG9tTXV0YXNoYWJpaFtdO1xuICAgIGN5Y2xlU3RhcnQ/OiBzdHJpbmc7XG4gICAgbGlzdGVuaW5nQ29tcGxldGU/OiBzdHJpbmcgfCBudWxsO1xuICAgIGV4cG9ydGVkQXQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4cG9ydEJhY2t1cCgpOiBCYWNrdXBEYXRhIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBzZXR0aW5nczogZ2V0U2V0dGluZ3MoKSxcbiAgICAgICAgbWVtb3J5Tm9kZXM6IGdldE1lbW9yeU5vZGVzKCksXG4gICAgICAgIG1pbmRtYXBzOiBnZXRNaW5kTWFwcygpLFxuICAgICAgICBwYXJ0TWluZG1hcHM6IGdldFBhcnRNaW5kTWFwcygpLFxuICAgICAgICBsaXN0ZW5pbmdTdGF0czogZ2V0TGlzdGVuaW5nU3RhdHMoKSxcbiAgICAgICAgbGlzdGVuaW5nUHJvZ3Jlc3M6IGdldEZyb21DYWNoZShTVE9SQUdFX0tFWVMuTElTVEVOSU5HX1BST0dSRVNTLCB7fSksXG4gICAgICAgIHJldmlld0Vycm9yczogZ2V0UmV2aWV3RXJyb3JzKCksXG4gICAgICAgIG11dGFzaGFiaWhhdERlY2lzaW9uczogZ2V0TXV0YXNoYWJpaGF0RGVjaXNpb25zKCksXG4gICAgICAgIGN1c3RvbU11dGFzaGFiaWhhdDogZ2V0Q3VzdG9tTXV0YXNoYWJpaGF0KCksXG4gICAgICAgIGN5Y2xlU3RhcnQ6IGdldEN5Y2xlU3RhcnQoKSxcbiAgICAgICAgbGlzdGVuaW5nQ29tcGxldGU6IGdldEZyb21DYWNoZShTVE9SQUdFX0tFWVMuTElTVEVOSU5HX0NPTVBMRVRFLCBudWxsKSxcbiAgICAgICAgZXhwb3J0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbXBvcnRCYWNrdXAoZGF0YTogQmFja3VwRGF0YSk6IHZvaWQge1xuICAgIGlmIChkYXRhLnNldHRpbmdzKSBzYXZlU2V0dGluZ3MoZGF0YS5zZXR0aW5ncyk7XG4gICAgaWYgKGRhdGEubWVtb3J5Tm9kZXMpIHNhdmVNZW1vcnlOb2RlcyhkYXRhLm1lbW9yeU5vZGVzKTtcbiAgICBpZiAoZGF0YS5taW5kbWFwcykge1xuICAgICAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5NSU5ETUFQUywgZGF0YS5taW5kbWFwcyk7XG4gICAgfVxuICAgIGlmIChkYXRhLnBhcnRNaW5kbWFwcykge1xuICAgICAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5QQVJUX01JTkRNQVBTLCBkYXRhLnBhcnRNaW5kbWFwcyk7XG4gICAgfVxuICAgIGlmIChkYXRhLmxpc3RlbmluZ1N0YXRzKSB7XG4gICAgICAgIHNhdmVUb0NhY2hlQW5kU3RvcmUoU1RPUkFHRV9LRVlTLkxJU1RFTklOR19TVEFUUywgZGF0YS5saXN0ZW5pbmdTdGF0cyk7XG4gICAgfVxuICAgIGlmIChkYXRhLmxpc3RlbmluZ1Byb2dyZXNzKSB7XG4gICAgICAgIHNhdmVUb0NhY2hlQW5kU3RvcmUoU1RPUkFHRV9LRVlTLkxJU1RFTklOR19QUk9HUkVTUywgZGF0YS5saXN0ZW5pbmdQcm9ncmVzcyk7XG4gICAgfVxuICAgIGlmIChkYXRhLnJldmlld0Vycm9ycykge1xuICAgICAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5SRVZJRVdfRVJST1JTLCBkYXRhLnJldmlld0Vycm9ycyk7XG4gICAgfVxuICAgIGlmIChkYXRhLm11dGFzaGFiaWhhdERlY2lzaW9ucykge1xuICAgICAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5NVVRBU0hBQklIQVRfREVDSVNJT05TLCBkYXRhLm11dGFzaGFiaWhhdERlY2lzaW9ucyk7XG4gICAgfVxuICAgIGlmIChkYXRhLmN1c3RvbU11dGFzaGFiaWhhdCkge1xuICAgICAgICBzYXZlVG9DYWNoZUFuZFN0b3JlKFNUT1JBR0VfS0VZUy5DVVNUT01fTVVUQVNIQUJJSEFULCBkYXRhLmN1c3RvbU11dGFzaGFiaWhhdCk7XG4gICAgfVxuICAgIGlmIChkYXRhLmN5Y2xlU3RhcnQpIHNldEN5Y2xlU3RhcnQoZGF0YS5jeWNsZVN0YXJ0KTtcbiAgICBpZiAoZGF0YS5saXN0ZW5pbmdDb21wbGV0ZSkgc2F2ZVRvQ2FjaGVBbmRTdG9yZShTVE9SQUdFX0tFWVMuTElTVEVOSU5HX0NPTVBMRVRFLCBkYXRhLmxpc3RlbmluZ0NvbXBsZXRlKTtcbn1cbiJdLCJuYW1lcyI6WyJTVVJBSFMiLCJnZXQiLCJzZXQiLCJjcmVhdGVTdG9yZSIsImN1c3RvbVN0b3JlIiwidW5kZWZpbmVkIiwibWlncmF0ZUZyb21Mb2NhbFN0b3JhZ2UiLCJtaWdyYXRpb25GbGFnIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImtleSIsIk9iamVjdCIsInZhbHVlcyIsIlNUT1JBR0VfS0VZUyIsInZhbHVlIiwiSlNPTiIsInBhcnNlIiwiZSIsImNvbnNvbGUiLCJlcnJvciIsInNldEl0ZW0iLCJsb2ciLCJzdG9yYWdlQ2FjaGUiLCJsb2FkSW50b0NhY2hlIiwiZ2V0RnJvbUNhY2hlIiwiZGVmYXVsdFZhbHVlIiwiY2FjaGVkIiwic2F2ZVRvQ2FjaGVBbmRTdG9yZSIsImNhdGNoIiwiZXJyIiwiU0VUVElOR1MiLCJNRU1PUllfTk9ERVMiLCJNSU5ETUFQUyIsIlBBUlRfTUlORE1BUFMiLCJMSVNURU5JTkdfUFJPR1JFU1MiLCJMSVNURU5JTkdfU1RBVFMiLCJDWUNMRV9TVEFSVCIsIkxJU1RFTklOR19DT01QTEVURSIsIlJFVklFV19FUlJPUlMiLCJNVVRBU0hBQklIQVRfREVDSVNJT05TIiwiQ1VTVE9NX01VVEFTSEFCSUhBVCIsIkRFRkFVTFRfU0VUVElOR1MiLCJjb21wbGV0aW9uRGF5cyIsImFjdGl2ZVBhcnQiLCJsZWFybmVkVmVyc2VzIiwic2tpcHBlZFN1cmFocyIsImdldFNldHRpbmdzIiwic2F2ZVNldHRpbmdzIiwic2V0dGluZ3MiLCJ1cGRhdGVTZXR0aW5nIiwiaXNTdXJhaFNraXBwZWQiLCJzdXJhaElkIiwiaW5jbHVkZXMiLCJ0b2dnbGVTdXJhaFNraXBwZWQiLCJjdXJyZW50IiwiU2V0IiwiaGFzIiwiZGVsZXRlIiwiYWRkIiwicHJ1bmVTdXJhaEFydGlmYWN0cyIsIkFycmF5IiwiZnJvbSIsInNvcnQiLCJhIiwiYiIsImlzVmVyc2VMZWFybmVkIiwiYXlhaElkIiwidG9nZ2xlVmVyc2VMZWFybmVkIiwic3VyYWhLZXkiLCJ0b1N0cmluZyIsImZpbHRlciIsInYiLCJsZW5ndGgiLCJzeW5jTWVtb3J5Tm9kZXNXaXRoTGVhcm5lZCIsInRvZ2dsZVN1cmFoTGVhcm5lZCIsInN1cmFoIiwiZmluZCIsInMiLCJpZCIsInZlcnNlQ291bnQiLCJfIiwiaSIsImdldFN1cmFoTGVhcm5lZFN0YXR1cyIsImxlYXJuZWQiLCJ0b3RhbCIsImdldFRvdGFsTGVhcm5lZFZlcnNlcyIsInJlZHVjZSIsInN1bSIsInZlcnNlcyIsImdldExlYXJuZWRWZXJzZXNJblBhcnQiLCJwYXJ0IiwicmVzdWx0IiwiZm9yRWFjaCIsInB1c2giLCJnZXRNZW1vcnlOb2RlcyIsInNhdmVNZW1vcnlOb2RlcyIsIm5vZGVzIiwiZ2V0RHVlTm9kZXMiLCJ0b2RheSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNwbGl0Iiwic2tpcHMiLCJzdXNwZW5kZWQiLCJnZXRTdXNwZW5kZWRBbmNob3JzIiwibiIsInNjaGVkdWxlciIsImR1ZURhdGUiLCJpc05vZGVTdXNwZW5kZWQiLCJ1cGRhdGVNZW1vcnlOb2RlIiwibm9kZSIsImluZGV4IiwiZmluZEluZGV4IiwiY3JlYXRlTmV3U2NoZWR1bGVyIiwiaW50ZXJ2YWwiLCJyZXBldGl0aW9uIiwiZWFzZUZhY3RvciIsImxhc3RSZXZpZXciLCJmb3JjZUZ1bGxSZXNldCIsImVudHJpZXMiLCJzdXJhaElkU3RyIiwicGFyc2VJbnQiLCJzb3J0ZWRWZXJzZXMiLCJzZWdtZW50U3RhcnQiLCJzZWdtZW50RW5kIiwiaXNDb250aWd1b3VzIiwic2VnbWVudFNpemUiLCJub2RlSWQiLCJleGlzdHMiLCJzb21lIiwibmV3Tm9kZSIsInR5cGUiLCJzdGFydFZlcnNlIiwiZW5kVmVyc2UiLCJtaW5kbWFwcyIsImdldE1pbmRNYXBzIiwibW0iLCJpc0NvbXBsZXRlIiwicGFydE1pbmRtYXBzIiwiZ2V0UGFydE1pbmRNYXBzIiwicG1tIiwicGFydElkIiwic20yIiwiZ3JhZGUiLCJzdGF0ZSIsIk1hdGgiLCJyb3VuZCIsIm1heCIsInNldERhdGUiLCJnZXREYXRlIiwicG9zdHBvbmVOb2RlIiwidG9tb3Jyb3ciLCJnZXRNaW5kTWFwIiwibWFwcyIsImltYWdlVXJsIiwiYW5jaG9ycyIsInNhdmVNaW5kTWFwIiwibWluZG1hcCIsImdldFBhcnRNaW5kTWFwIiwiZGVzY3JpcHRpb24iLCJzYXZlUGFydE1pbmRNYXAiLCJnZXRMaXN0ZW5pbmdQcm9ncmVzcyIsIm1hcCIsImN1cnJlbnRWZXJzZUluZGV4Iiwic2F2ZUxpc3RlbmluZ1Byb2dyZXNzIiwiZ2V0TGlzdGVuaW5nU3RhdHMiLCJnZXRMaXN0ZW5pbmdTdGF0c0ZvclN1cmFoIiwic3RhdHMiLCJ0b3RhbE1pbnV0ZXMiLCJsYXN0TGlzdGVuZWQiLCJhZGRMaXN0ZW5pbmdUaW1lIiwibWludXRlcyIsImdldExpc3RlbmluZ0NvbXBsZXRlZFRvZGF5Iiwic3RvcmVkIiwibWFya0xpc3RlbmluZ0NvbXBsZXRlIiwiZ2V0UmV2aWV3RXJyb3JzIiwic2F2ZVJldmlld0Vycm9yIiwiZXJyb3JzIiwidHJpbW1lZCIsInNsaWNlIiwicmVtb3ZlUmV2aWV3RXJyb3IiLCJyZW1haW5pbmciLCJnZXRFcnJvcnNCeUFuY2hvciIsImFuY2hvckNvdW50cyIsImFuY2hvciIsImxhYmVsIiwiY291bnQiLCJhbmNob3JJZCIsImdldEN5Y2xlU3RhcnQiLCJzZXRDeWNsZVN0YXJ0IiwiZGF0ZSIsImdldEN1cnJlbnREYXlJbkN5Y2xlIiwic3RhcnQiLCJkaWZmIiwiZmxvb3IiLCJnZXRUaW1lIiwic2V0U3VyYWhNYXR1cml0eSIsImxldmVsIiwibm93IiwidXBkYXRlZE5vZGVzIiwiZWZhY3RvciIsImppdHRlciIsInJhbmRvbSIsInJlc2V0QWxsTWF0dXJpdHkiLCJ0aHJlc2hvbGQiLCJjbGVhckFuY2hvcklzc3VlcyIsInN0cmluZ2lmeSIsImZpbmRBbmNob3JGb3JSYW5nZSIsImdldEN1c3RvbU11dGFzaGFiaWhhdCIsInNhdmVDdXN0b21NdXRhc2hhYmloIiwibXV0IiwiYWxsIiwiZXhpc3RpbmdJZHgiLCJtIiwiZGVsZXRlQ3VzdG9tTXV0YXNoYWJpaCIsImdldE11dGFzaGFiaWhhdERlY2lzaW9ucyIsInNldE11dGFzaGFiaWhhdERlY2lzaW9uIiwiYWJzb2x1dGVBeWFoIiwiZGVjaXNpb24iLCJwaHJhc2VJZCIsImRlY2lzaW9ucyIsInJlc2V0TXV0YXNoYWJpaGF0RGVjaXNpb25zIiwiYWJzb2x1dGVBeWF0Iiwia2V5c1RvRGVsZXRlIiwia2V5cyIsImFicyIsImJ1bGtTZXRTdXJhaFN0YXR1cyIsInN1cmFoSWRzIiwic3RhdHVzIiwiYWxsU3VyYWhzIiwic0lkIiwidmVyc2VJZHMiLCJyZW1haW5pbmdFcnJvcnMiLCJpc3N1ZXMiLCJyZWxhdGVkSXNzdWVzIiwiZXhwb3J0QmFja3VwIiwibWVtb3J5Tm9kZXMiLCJsaXN0ZW5pbmdTdGF0cyIsImxpc3RlbmluZ1Byb2dyZXNzIiwicmV2aWV3RXJyb3JzIiwibXV0YXNoYWJpaGF0RGVjaXNpb25zIiwiY3VzdG9tTXV0YXNoYWJpaGF0IiwiY3ljbGVTdGFydCIsImxpc3RlbmluZ0NvbXBsZXRlIiwiZXhwb3J0ZWRBdCIsImltcG9ydEJhY2t1cCIsImRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/storage.ts\n"));

/***/ })

});